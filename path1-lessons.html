<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Path 1 Lessons - FinanceU</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="assets/favicon-16x16.svg">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="assets/favicon-32x32.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.svg">
    <link rel="stylesheet" href="styles.css">
    <style>
        /* SVG Icon Alignment Fixes */
        svg {
            display: inline-block;
            vertical-align: middle;
        }

        .intro-card-icon svg,
        .mistake-icon svg,
        .reflection-icon svg,
        .result-icon svg {
            display: block;
            margin: 0 auto;
        }

        .budget-method-emoji svg,
        .budget-item-label svg {
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }

        p svg, li svg, span svg {
            display: inline-block;
            vertical-align: middle;
            margin: 0 2px;
        }

        .path-header {
            background: #FFFFFF;
            color: #000000;
            padding: 60px 20px 40px;
            text-align: center;
            border-bottom: 1px solid #e5e5e5;
        }
        .path-header h1 {
            font-size: 42px;
            margin-bottom: 15px;
        }
        .path-header p {
            font-size: 18px;
            color: #4a4a4a;
            max-width: 700px;
            margin: 0 auto;
        }
        .lessons-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 20px;
        }
        .lesson-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            border-left: 4px solid transparent;
        }
        .lesson-card::before {
            content: attr(data-lesson);
            position: absolute;
            left: 25px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: #2563eb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
        }
        .lesson-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border-left-color: #2563eb;
        }
        .lesson-card.completed {
            background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%);
            border: 2px solid #00A676;
            border-left: 4px solid #00A676;
        }
        .lesson-card.completed::before {
            background: linear-gradient(135deg, #00A676 0%, #10b981 100%);
            box-shadow: 0 2px 8px rgba(0, 166, 118, 0.3);
        }
        .lesson-info {
            margin-left: 60px;
        }
        .lesson-info h3 {
            font-size: 22px;
            margin-bottom: 8px;
            color: var(--text-primary);
        }
        .lesson-info p {
            color: var(--text-secondary);
            font-size: 15px;
            margin: 0;
        }
        .lesson-status {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .completed-badge {
            background: linear-gradient(135deg, #00A676 0%, #10b981 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 8px rgba(0, 166, 118, 0.3);
        }
        .btn-start-lesson {
            padding: 12px 24px;
            background: #2563eb;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: background 0.2s;
            border: none;
            cursor: pointer;
            white-space: nowrap;
        }
        .btn-start-lesson:hover {
            background: #1d4ed8;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #2563eb;
            text-decoration: none;
            font-weight: 600;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .quiz-card {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 12px;
            padding: 30px;
            margin-top: 40px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }
        .quiz-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }
        .quiz-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(251, 191, 36, 0.4);
        }
        .quiz-card .lesson-info {
            margin-left: 0;
            position: relative;
            z-index: 1;
        }
        .quiz-card .lesson-info h3 {
            color: white;
            font-size: 26px;
        }
        .quiz-card .lesson-info p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 15px;
        }
        .btn-start-quiz {
            padding: 14px 28px;
            background: white;
            color: #f59e0b;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 700;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }
        .btn-start-quiz:hover {
            background: #fffbeb;
            transform: scale(1.05);
        }
        .quiz-completed-badge {
            background: #00A676;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body class="homepage-dark">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo"><a href="/" style="color: inherit; text-decoration: none;">Finance<span class="logo-accent">U</span></a></div>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="dashboard">Dashboard</a></li>
                    <li id="authButtons" style=" opacity: 0;">
                    </li>
                    </li>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Path Header -->
    <section class="path-header">
        <h1>Path 1: Banking Basics</h1>
        <p>Learn about different types of banks and how to navigate them with confidence</p>
    </section>

    <!-- Lessons List -->
    <div class="lessons-container">
        <a href="dashboard" class="back-link">‚Üê Back to Dashboard</a>

        <div id="lessonsList">
            <!-- Intro Button -->
            <div class="lesson-card" data-lesson="üìñ" style="background: linear-gradient(135deg, #E0F2FE 0%, #BAE6FD 100%); border-left: 4px solid #3B82F6;">
                <div class="lesson-info">
                    <h3>Start Here: Banking Basics for Beginners</h3>
                    <p>Never opened a bank account? No worries‚Äîwe'll walk through the basics together</p>
                </div>
                <div class="lesson-status">
                    <a href="/path1-intro" class="btn-start-lesson" style="background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);">Read Intro</a>
                </div>
            </div>

            <!-- Lesson 1 -->
            <div class="lesson-card" data-lesson="1">
                <div class="lesson-info">
                    <h3>Lesson 1 - Types of Banks (Online vs. In-Person)</h3>
                    <p>Learn about online and traditional banks, their differences, and how to navigate them</p>
                </div>
                <div class="lesson-status">
                    <a href="/path1-lesson1" class="btn-start-lesson">Start Lesson</a>
                </div>
            </div>

            <!-- Lesson 2 -->
            <div class="lesson-card" data-lesson="2">
                <div class="lesson-info">
                    <h3>Lesson 2 - Checking Accounts</h3>
                    <p>Learn what checking accounts are, how to use debit cards, and manage your everyday money</p>
                </div>
                <div class="lesson-status">
                    <a href="/path1-lesson2" class="btn-start-lesson">Start Lesson</a>
                </div>
            </div>

            <!-- Lesson 3 -->
            <div class="lesson-card" data-lesson="3">
                <div class="lesson-info">
                    <h3>Lesson 3 - Savings Accounts</h3>
                    <p>Learn what savings accounts are, how they earn interest, and how to manage your savings properly</p>
                </div>
                <div class="lesson-status">
                    <a href="/path1-lesson3" class="btn-start-lesson">Start Lesson</a>
                </div>
            </div>

            <!-- Lesson 4 -->
            <div class="lesson-card" data-lesson="4">
                <div class="lesson-info">
                    <h3>Lesson 4 - High-Yield Savings Accounts</h3>
                    <p>Learn how to make your savings work harder with high-yield accounts and understand the real difference they make</p>
                </div>
                <div class="lesson-status">
                    <a href="/path1-lesson4" class="btn-start-lesson">Start Lesson</a>
                </div>
            </div>

            <!-- Lesson 5 - Coming Soon -->
            <div class="lesson-card" data-lesson="5" style="opacity: 0.6; pointer-events: none;">
                <div class="lesson-info">
                    <h3>Lesson 5 - Coming Soon</h3>
                    <p>More banking lessons will be available soon</p>
                </div>
                <div class="lesson-status">
                    <span style="color: #9ca3af; font-weight: 600;">Unavailable</span>
                </div>
            </div>

            <!-- Final Quiz -->
            <div class="quiz-card" id="quizCard" style="display: none;">
                <div class="lesson-info">
                    <h3><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><polygon points="10,5 2,9 10,13 18,9" fill="#3B82F6"/><polygon points="10,13 6,11 6,14 10,16 14,14 14,11" fill="#60A5FA"/></svg> Final Quiz</h3>
                    <p>Test your knowledge of all 8 lessons ‚Ä¢ 16 questions ‚Ä¢ 80% to pass</p>
                </div>
                <div class="lesson-status">
                    <a href="/path1-quiz" class="btn-start-quiz">Take Quiz</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FinanceU</h4>
                    <p>Making financial literacy accessible for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/careers">Careers</a></li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="/help">Help Center</a></li>
                        <li><a href="/privacy">Privacy Policy</a></li>
                        <li><a href="/terms">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p style=" font-size: 0.85rem; opacity: 0.8; margin-bottom: 10px;">Disclaimer: FinanceU provides educational content only and does not offer financial, legal, or investment advice. Always consult with a qualified professional before making financial decisions.</p>
                <p>&copy; 2025 FinanceU. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script src="lesson-sync.js"></script>
    <script src="animations.js"></script>
    <script>
        // Check authentication status and update nav
                        async function updateNav() {
            const authButtons = document.getElementById('authButtons');

            // Check localStorage for cached auth state and render immediately
            const cachedAuth = localStorage.getItem('authState');
            if (cachedAuth) {
                const authState = JSON.parse(cachedAuth);
                authButtons.innerHTML = authState.isLoggedIn
                    ? `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`
                    : `<a href="login" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }

            // Then verify with server in background
            try {
                const response = await fetch(`${API_URL}/auth/me`, { credentials: 'include' });

                if (response.ok) {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: true }));
                    authButtons.innerHTML = `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`;
                } else {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                    authButtons.innerHTML = `<a href="login" class="btn-primary">Login</a>`;
                }
                authButtons.style.opacity = '1';
            } catch (error) {
                console.log('Not logged in');
                localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                authButtons.innerHTML = `<a href="login" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }
        }
        // Logout function
        async function logout() {
            // Clear auth data only - keep user-specific progress data
            localStorage.removeItem('authState');
            localStorage.removeItem('token');
            localStorage.removeItem('userId');

            try {
                await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/index.html';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/index.html';
            }
        }

        // Load completed lessons and handle locking logic
        function loadCompletedLessons() {
            const userId = localStorage.getItem('userId');

            // If no userId, don't load any progress (user not logged in)
            if (!userId || userId === 'null' || userId === 'undefined') {
                return;
            }

            const completed = JSON.parse(localStorage.getItem(`path1_completed_${userId}`) || '[]');

            // Handle Lesson 1 (always unlocked)
            const lesson1Card = document.querySelector(`[data-lesson="1"]`);
            if (lesson1Card) {
                const statusDiv = lesson1Card.querySelector('.lesson-status');

                if (completed.includes(1)) {
                    lesson1Card.classList.add('completed');
                    statusDiv.innerHTML = `
                        <span class="completed-badge">Completed</span>
                        <a href="/path1-lesson1" class="btn-start-lesson">Review</a>
                    `;
                }
            }

            // Handle Lesson 2 (requires lesson 1 quiz to be passed)
            const lesson2Card = document.querySelector(`[data-lesson="2"]`);
            if (lesson2Card) {
                const statusDiv = lesson2Card.querySelector('.lesson-status');
                const lesson1QuizPassed = localStorage.getItem(`lesson1_quiz_passed_${userId}`) === 'true';

                if (!lesson1QuizPassed) {
                    // Lock lesson 2
                    lesson2Card.style.opacity = '0.6';
                    lesson2Card.style.pointerEvents = 'none';
                    statusDiv.innerHTML = `
                        <span style="color: #9ca3af; font-weight: 600; white-space: nowrap;"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="9" width="10" height="8" rx="1" fill="#6B7280"/><path d="M7 9 L7 6 C7 4.3 8.3 3 10 3 C11.7 3 13 4.3 13 6 L13 9" stroke="#6B7280" stroke-width="2" fill="none"/></svg> Complete Lesson 1</span>
                    `;
                } else if (completed.includes(2)) {
                    // Lesson 2 completed
                    lesson2Card.classList.add('completed');
                    statusDiv.innerHTML = `
                        <span class="completed-badge">Completed</span>
                        <a href="/path1-lesson2" class="btn-start-lesson">Review</a>
                    `;
                }
                // If lesson 1 quiz passed but not completed, button already shows "Start Lesson"
            }

            // Handle Lesson 3 (requires lesson 2 quiz to be passed)
            const lesson3Card = document.querySelector(`[data-lesson="3"]`);
            if (lesson3Card) {
                const statusDiv = lesson3Card.querySelector('.lesson-status');
                const lesson2QuizPassed = localStorage.getItem(`lesson2_quiz_passed_${userId}`) === 'true';

                if (!lesson2QuizPassed) {
                    // Lock lesson 3
                    lesson3Card.style.opacity = '0.6';
                    lesson3Card.style.pointerEvents = 'none';
                    statusDiv.innerHTML = `
                        <span style="color: #9ca3af; font-weight: 600; white-space: nowrap;"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="9" width="10" height="8" rx="1" fill="#6B7280"/><path d="M7 9 L7 6 C7 4.3 8.3 3 10 3 C11.7 3 13 4.3 13 6 L13 9" stroke="#6B7280" stroke-width="2" fill="none"/></svg> Complete Lesson 2</span>
                    `;
                } else if (completed.includes(3)) {
                    // Lesson 3 completed
                    lesson3Card.classList.add('completed');
                    statusDiv.innerHTML = `
                        <span class="completed-badge">Completed</span>
                        <a href="/path1-lesson3" class="btn-start-lesson">Review</a>
                    `;
                }
                // If lesson 2 quiz passed but not completed, button already shows "Start Lesson"
            }

            // Handle Lesson 4 (requires lesson 3 quiz to be passed)
            const lesson4Card = document.querySelector(`[data-lesson="4"]`);
            if (lesson4Card) {
                const statusDiv = lesson4Card.querySelector('.lesson-status');
                const lesson3QuizPassed = localStorage.getItem(`lesson3_quiz_passed_${userId}`) === 'true';

                if (!lesson3QuizPassed) {
                    // Lock lesson 4
                    lesson4Card.style.opacity = '0.6';
                    lesson4Card.style.pointerEvents = 'none';
                    statusDiv.innerHTML = `
                        <span style="color: #9ca3af; font-weight: 600; white-space: nowrap;"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="9" width="10" height="8" rx="1" fill="#6B7280"/><path d="M7 9 L7 6 C7 4.3 8.3 3 10 3 C11.7 3 13 4.3 13 6 L13 9" stroke="#6B7280" stroke-width="2" fill="none"/></svg> Complete Lesson 3</span>
                    `;
                } else if (completed.includes(4)) {
                    // Lesson 4 completed
                    lesson4Card.classList.add('completed');
                    statusDiv.innerHTML = `
                        <span class="completed-badge">Completed</span>
                        <a href="/path1-lesson4" class="btn-start-lesson">Review</a>
                    `;
                }
                // If lesson 3 quiz passed but not completed, button already shows "Start Lesson"
            }
        }

        // Check if all lessons completed and show quiz
        function checkQuizAvailability() {
            const quizCard = document.getElementById('quizCard');

            // Hide quiz card since only Lesson 1 is available (Lessons 2-8 coming soon)
            // Final quiz will be shown when all lessons are released
            quizCard.style.display = 'none';
        }

        // Initialize page with progress sync
        async function initializePage() {
            await updateNav();
            const syncResult = await syncLessonProgress();
            console.log('Sync result:', syncResult);
            loadCompletedLessons();
            checkQuizAvailability();
        }

        initializePage();
    </script>
</body>
</html>
