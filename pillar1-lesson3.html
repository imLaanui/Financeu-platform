<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 3 - The Time Value of Money - FinanceU</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .lesson-container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }
        .lesson-header { text-align: center; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 3px solid var(--primary-color); }
        .lesson-header h1 { font-size: 36px; color: var(--text-primary); margin-bottom: 10px; }
        .lesson-header .lesson-number { color: var(--primary-color); font-size: 18px; font-weight: 600; margin-bottom: 5px; }
        .lesson-section { background: white; padding: 30px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .lesson-section h2 { color: var(--primary-color); font-size: 24px; margin-bottom: 15px; }
        .lesson-section p { line-height: 1.8; color: var(--text-secondary); margin-bottom: 15px; }
        .lesson-section ul { line-height: 1.8; color: var(--text-secondary); margin-left: 20px; margin-bottom: 15px; }
        .visual-box { background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border-left: 4px solid var(--primary-color); padding: 20px; border-radius: 8px; margin: 20px 0; }
        .visual-box h3 { color: var(--primary-color); margin-bottom: 15px; font-size: 18px; }
        .timeline { display: flex; justify-content: space-around; align-items: flex-end; margin-top: 20px; gap: 10px; }
        .timeline-item { text-align: center; flex: 1; }
        .timeline-box { background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
        .timeline-box.highlight { background: #10b981; color: white; font-weight: bold; }
        .action-box { background: #10b98120; border-left: 4px solid #10b981; padding: 20px; border-radius: 8px; }
        .action-box h3 { color: #10b981; margin-bottom: 10px; }
        .reflection-box { background: #f59e0b20; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px; }
        .reflection-box h3 { color: #f59e0b; margin-bottom: 10px; }
        .mistakes-list { background: #fee2e2; padding: 20px; border-radius: 8px; border-left: 4px solid #dc2626; }
        .mistakes-list h3 { color: #dc2626; margin-bottom: 15px; }
        .btn-finish { display: block; width: 100%; max-width: 400px; margin: 30px auto; padding: 18px; background: var(--primary-color); color: white; text-align: center; text-decoration: none; border-radius: 8px; font-size: 18px; font-weight: 600; transition: background 0.2s; border: none; cursor: pointer; }
        .btn-finish:hover { background: #2563eb; }
        .back-link { display: inline-block; margin-bottom: 20px; color: var(--primary-color); text-decoration: none; font-weight: 600; }
        .back-link:hover { text-decoration: underline; }
        .quiz-container {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            padding: 30px;
            margin: 40px 0 30px 0;
        }
        .quiz-header {
            text-align: center;
            margin-bottom: 25px;
        }
        .quiz-header h2 {
            color: var(--primary-color);
            font-size: 28px;
            margin-bottom: 10px;
        }
        .quiz-header p {
            color: var(--text-secondary);
            font-size: 16px;
        }
        .question-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
        }
        .answer-option {
            background: #f9fafb;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .answer-option:hover {
            border-color: var(--primary-color);
            background: #eff6ff;
        }
        .answer-option.selected {
            border-color: var(--primary-color);
            background: #dbeafe;
        }
        .answer-option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }
        .answer-option.incorrect {
            border-color: #dc2626;
            background: #fee2e2;
        }
        .btn-submit-quiz {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 20px auto;
            padding: 15px;
            background: var(--primary-color);
            color: white;
            text-align: center;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-submit-quiz:hover {
            background: #2563eb;
        }
        .btn-submit-quiz:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .quiz-result {
            background: white;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
        }
        .quiz-result.pass {
            border: 3px solid #10b981;
        }
        .quiz-result.fail {
            border: 3px solid #dc2626;
        }
        .result-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        .result-text {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .result-score {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        .btn-retry {
            padding: 12px 24px;
            background: #f59e0b;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-retry:hover {
            background: #d97706;
        }
        .btn-finish:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo"><a href="index.html" style="color: inherit; text-decoration: none;">Finance<span class="logo-accent">U</span></a></div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li id="authButtons" style="opacity: 0;">
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="lesson-container">
        <a href="pillar1-lessons.html" class="back-link">‚Üê Back to Pillar 1 Lessons</a>

        <div class="lesson-header">
            <div class="lesson-number">LESSON 3</div>
            <h1>The Time Value of Money</h1>
        </div>

        <div class="lesson-section">
            <h2>Quick Intro</h2>
            <p>Here's a powerful financial truth: a dollar today is worth more than a dollar tomorrow. This isn't about inflation (though that's part of it)‚Äîit's about opportunity. Understanding the time value of money will change how you think about saving, spending, and investing. It's the concept that makes compound interest work in your favor and explains why starting early matters so much.</p>
        </div>

        <div class="lesson-section">
            <h2>Core Concept</h2>
            <p><strong>Money available now is worth more than the same amount in the future because it has the potential to grow.</strong></p>
            <p>Why does time affect money's value?</p>
            <ul>
                <li><strong>Growth Potential:</strong> Money you have now can be invested to earn returns, making it worth more later.</li>
                <li><strong>Inflation:</strong> Prices increase over time, meaning your dollar buys less in the future than it does today.</li>
                <li><strong>Opportunity Cost:</strong> Having money now gives you options and flexibility you won't have if you wait.</li>
                <li><strong>Risk:</strong> Money promised in the future isn't guaranteed‚Äîsomething could change before you receive it.</li>
            </ul>
            <p>This is why lenders charge interest and why investing early is so powerful. Time is literally money.</p>
        </div>

        <div class="lesson-section">
            <h2>Simple Example</h2>
            <p>Imagine someone offers you a choice:</p>
            <p><strong>Option A:</strong> Receive $1,000 today<br>
            <strong>Option B:</strong> Receive $1,000 one year from now</p>
            <p>Which should you choose? Option A, always!</p>
            <p>Here's why: If you take $1,000 today and put it in a savings account earning 5% interest, you'll have $1,050 in one year. That's $50 more than waiting. Even if you don't invest it, you have the option to use it for emergencies, opportunities, or needs that might arise this year.</p>
            <p>Now flip it: Would you lend someone $1,000 today if they promised to pay you back exactly $1,000 in a year? Probably not, because you're losing the opportunity to grow that money. That's why lenders charge interest‚Äîthey need to be compensated for giving up that growth potential.</p>
        </div>

        <div class="visual-box">
            <h3>$100 Saved at Age 20 vs. Age 30</h3>
            <p style="font-size: 14px; margin-bottom: 15px;">Assuming 7% annual growth until age 65:</p>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-box highlight">$1,497</div>
                    <p style="font-size: 13px; color: var(--text-secondary);">Started at 20<br>(45 years growth)</p>
                </div>
                <div class="timeline-item">
                    <div class="timeline-box">$761</div>
                    <p style="font-size: 13px; color: var(--text-secondary);">Started at 30<br>(35 years growth)</p>
                </div>
            </div>
            <p style="margin-top: 20px; text-align: center; font-weight: 600; color: var(--primary-color);">Starting 10 years earlier nearly doubles your money!</p>
        </div>

        <div class="lesson-section">
            <div class="mistakes-list">
                <h3>Common Mistakes to Avoid</h3>
                <ul style="margin-left: 20px;">
                    <li><strong>Thinking "I'll start saving later":</strong> Every year you wait costs you years of potential growth. Starting with $10/month now beats starting with $100/month in 10 years.</li>
                    <li><strong>Only thinking about today's value:</strong> That $50 you spend on takeout today could be worth $150 in 20 years if invested. Not every purchase needs this analysis, but it's worth considering for large expenses.</li>
                    <li><strong>Ignoring inflation:</strong> Money sitting under your mattress loses value every year. You need growth just to stay even.</li>
                    <li><strong>Not asking for payment terms:</strong> If someone owes you money, getting it sooner rather than later matters. Don't be afraid to ask when you'll be repaid.</li>
                </ul>
            </div>
        </div>

        <div class="lesson-section">
            <div class="action-box">
                <h3>üéØ Your Micro Action</h3>
                <p><strong>Calculate your "coffee future":</strong></p>
                <p>Think of something small you buy regularly (coffee, snacks, subscriptions). Multiply the weekly cost by 52 to get your annual spending. Then multiply by 30 to see what that money could be worth in 30 years if invested at 7% average returns.</p>
                <p>Example: $5 coffee twice a week = $10/week = $520/year = ~$50,000 in 30 years!</p>
                <p>This isn't to make you feel guilty‚Äîit's to show you the power of time. You get to decide what's worth it.</p>
            </div>
        </div>

        <div class="lesson-section">
            <div class="reflection-box">
                <h3>üí≠ Quick Reflection</h3>
                <p><strong>Think about this:</strong></p>
                <p>What opportunities have you missed because you "didn't have money right now"? What could change in your life if you started building wealth today, even with small amounts? The goal isn't to never spend‚Äîit's to understand that every financial decision is also a decision about your future.</p>
                <p style="margin-top: 15px; font-size: 14px; font-style: italic;">Consider this before moving forward.</p>
            </div>
        </div>

        <!-- Lesson Quiz -->
        <div class="quiz-container" id="quizContainer">
            <div class="quiz-header">
                <h2>Lesson Quiz</h2>
                <p>Answer these questions to unlock the next lesson. You need 80% (3 out of 4) to pass.</p>
            </div>
            <div id="quizQuestions"></div>
            <button class="btn-submit-quiz" id="submitQuiz" onclick="submitQuiz()">Submit Quiz</button>
            <div id="quizResult"></div>
        </div>

        <button class="btn-finish" id="finishBtn" onclick="finishLesson()" disabled>Finish Lesson</button>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FinanceU</h4>
                    <p>Making financial literacy accessible for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="help.html">Help Center</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 10px;">Disclaimer: FinanceU provides educational content only and does not offer financial, legal, or investment advice. Always consult with a qualified professional before making financial decisions.</p>
                <p>&copy; 2025 FinanceU. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script>
        async function updateNav() {
            try {
                const response = await fetch(`${API_URL}/auth/me`, { credentials: 'include' });
                const authButtons = document.getElementById('authButtons');
                if (response.ok) {
                    authButtons.innerHTML = `<a href="dashboard.html" class="btn-primary">Dashboard</a>`;
                } else {
                    authButtons.innerHTML = `<a href="login.html" class="btn-primary">Login</a>`;
                }
            } catch (error) {
                console.log('Not logged in');
            }
        }

        // Quiz data with multiple versions of each question
        const quizData = [
            {
                versions: [
                    {
                        question: "Why is a dollar today worth more than a dollar tomorrow?",
                        options: [
                            "Because of inflation only",
                            "Because it has the potential to grow and earn returns",
                            "Because dollars lose value immediately",
                            "Because tomorrow never comes"
                        ],
                        correct: 1
                    },
                    {
                        question: "What is the main concept of the time value of money?",
                        options: [
                            "Money loses all value over time",
                            "Money available now is worth more than the same amount in the future",
                            "Future money is always worth more",
                            "Time and money are unrelated"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "According to the lesson, what would $100 saved at age 20 be worth at age 65 (assuming 7% growth)?",
                        options: [
                            "$500",
                            "$761",
                            "$1,000",
                            "$1,497"
                        ],
                        correct: 3
                    },
                    {
                        question: "Starting to save 10 years earlier can have what effect on your money?",
                        options: [
                            "No significant difference",
                            "Nearly doubles your money",
                            "Triples your money",
                            "Reduces your returns"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "If someone offers you $1,000 today or $1,000 in one year, which should you choose?",
                        options: [
                            "Wait for one year to get it",
                            "Take it today because it can grow and has more value now",
                            "It doesn't matter, they're the same",
                            "Wait because future money is safer"
                        ],
                        correct: 1
                    },
                    {
                        question: "Why would lenders charge interest on money they lend?",
                        options: [
                            "To be greedy",
                            "Because it's required by law",
                            "To compensate for giving up the opportunity to grow that money",
                            "To punish borrowers"
                        ],
                        correct: 2
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "What common mistake involves delaying saving for the future?",
                        options: [
                            "Starting too early",
                            "Thinking 'I'll start saving later'",
                            "Saving too much now",
                            "Ignoring current needs"
                        ],
                        correct: 1
                    },
                    {
                        question: "According to the lesson, what is a consequence of money sitting under your mattress?",
                        options: [
                            "It grows slowly",
                            "It stays the same forever",
                            "It loses value every year due to inflation",
                            "It becomes more valuable"
                        ],
                        correct: 2
                    }
                ]
            }
        ];

        let currentQuestions = [];
        let userAnswers = [];
        let quizPassed = false;

        function initQuiz() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                console.error('No valid userId found');
                document.getElementById('finishBtn').disabled = true;
                return;
            }

            const quizPassedStatus = localStorage.getItem(`lesson3_quiz_passed_${userId}`);

            if (quizPassedStatus === 'true') {
                quizPassed = true;
                document.getElementById('finishBtn').disabled = false;
                document.getElementById('quizContainer').style.display = 'none';
                return;
            }

            currentQuestions = quizData.map(q => {
                const randomVersion = q.versions[Math.floor(Math.random() * q.versions.length)];
                return randomVersion;
            });

            renderQuiz();
        }

        function renderQuiz() {
            const questionsContainer = document.getElementById('quizQuestions');
            questionsContainer.innerHTML = '';
            userAnswers = new Array(currentQuestions.length).fill(null);

            currentQuestions.forEach((q, qIndex) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.innerHTML = `
                    <div class="question-text">Question ${qIndex + 1}: ${q.question}</div>
                    ${q.options.map((option, oIndex) => `
                        <div class="answer-option" onclick="selectAnswer(${qIndex}, ${oIndex})">
                            <input type="radio" name="question${qIndex}" value="${oIndex}" style="margin-right: 10px;">
                            ${option}
                        </div>
                    `).join('')}
                `;
                questionsContainer.appendChild(questionCard);
            });

            document.getElementById('submitQuiz').disabled = false;
            document.getElementById('quizResult').innerHTML = '';
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            const questionCard = document.querySelectorAll('.question-card')[questionIndex];
            const options = questionCard.querySelectorAll('.answer-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            currentQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = Math.round((correct / currentQuestions.length) * 100);
            const passed = percentage >= 80;

            document.querySelectorAll('.question-card').forEach((card, qIndex) => {
                const options = card.querySelectorAll('.answer-option');
                options.forEach((opt, oIndex) => {
                    opt.style.pointerEvents = 'none';
                    if (oIndex === currentQuestions[qIndex].correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[qIndex] && oIndex !== currentQuestions[qIndex].correct) {
                        opt.classList.add('incorrect');
                    }
                });
            });

            const resultDiv = document.getElementById('quizResult');
            if (passed) {
                quizPassed = true;
                const userId = localStorage.getItem('userId');
                localStorage.setItem(`lesson3_quiz_passed_${userId}`, 'true');
                document.getElementById('finishBtn').disabled = false;

                resultDiv.innerHTML = `
                    <div class="quiz-result pass">
                        <div class="result-icon">üéâ</div>
                        <div class="result-text" style="color: #10b981;">Quiz Passed!</div>
                        <div class="result-score">You scored ${correct} out of ${currentQuestions.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary);">Great job! You can now finish the lesson and move to the next one.</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="quiz-result fail">
                        <div class="result-icon">üìö</div>
                        <div class="result-text" style="color: #dc2626;">Not quite there yet</div>
                        <div class="result-score">You scored ${correct} out of ${currentQuestions.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">You need 80% to pass. Review the lesson and try again!</p>
                        <button class="btn-retry" onclick="retryQuiz()">Retry Quiz</button>
                    </div>
                `;
            }

            document.getElementById('submitQuiz').style.display = 'none';
        }

        function retryQuiz() {
            currentQuestions = quizData.map(q => {
                const randomVersion = q.versions[Math.floor(Math.random() * q.versions.length)];
                return randomVersion;
            });
            renderQuiz();
            document.getElementById('submitQuiz').style.display = 'block';
        }

        function finishLesson() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                alert('Please log in to save your progress.');
                return;
            }

            if (!quizPassed) {
                alert('Please complete the quiz first!');
                return;
            }

            const completed = JSON.parse(localStorage.getItem(`pillar1_completed_${userId}`) || '[]');

            if (!completed.includes(3)) {
                completed.push(3);
                localStorage.setItem(`pillar1_completed_${userId}`, JSON.stringify(completed));
            }

            window.location.href = 'pillar1-lessons.html';
        }

        updateNav();
        initQuiz();
    </script>
</body>
</html>
