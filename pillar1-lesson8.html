<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 8 - Building Good Money Habits - FinanceU</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .lesson-container { max-width: 800px; margin: 0 auto; padding: 40px 20px; }
        .lesson-header { text-align: center; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 3px solid var(--primary-color); }
        .lesson-header h1 { font-size: 36px; color: var(--text-primary); margin-bottom: 10px; }
        .lesson-header .lesson-number { color: var(--primary-color); font-size: 18px; font-weight: 600; margin-bottom: 5px; }
        .lesson-section { background: white; padding: 30px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .lesson-section h2 { color: var(--primary-color); font-size: 24px; margin-bottom: 15px; }
        .lesson-section p { line-height: 1.8; color: var(--text-secondary); margin-bottom: 15px; }
        .lesson-section ul { line-height: 1.8; color: var(--text-secondary); margin-left: 20px; margin-bottom: 15px; }
        .visual-box { background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border-left: 4px solid var(--primary-color); padding: 20px; border-radius: 8px; margin: 20px 0; }
        .visual-box h3 { color: var(--primary-color); margin-bottom: 15px; font-size: 18px; }
        .habits-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; }
        .habit-card { background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #10b981; }
        .action-box { background: #10b98120; border-left: 4px solid #10b981; padding: 20px; border-radius: 8px; }
        .action-box h3 { color: #10b981; margin-bottom: 10px; }
        .reflection-box { background: #f59e0b20; border-left: 4px solid #f59e0b; padding: 20px; border-radius: 8px; }
        .reflection-box h3 { color: #f59e0b; margin-bottom: 10px; }
        .mistakes-list { background: #fee2e2; padding: 20px; border-radius: 8px; border-left: 4px solid #dc2626; }
        .mistakes-list h3 { color: #dc2626; margin-bottom: 15px; }
        .completion-box { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 30px; border-radius: 12px; text-align: center; margin: 30px 0; }
        .completion-box h3 { font-size: 28px; margin-bottom: 15px; }
        .btn-finish { display: block; width: 100%; max-width: 400px; margin: 30px auto; padding: 18px; background: var(--primary-color); color: white; text-align: center; text-decoration: none; border-radius: 8px; font-size: 18px; font-weight: 600; transition: background 0.2s; border: none; cursor: pointer; }
        .btn-finish:hover { background: #2563eb; }
        .back-link { display: inline-block; margin-bottom: 20px; color: var(--primary-color); text-decoration: none; font-weight: 600; }
        .back-link:hover { text-decoration: underline; }
        .quiz-container { background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border: 2px solid var(--primary-color); border-radius: 12px; padding: 30px; margin: 40px 0 30px 0; }
        .quiz-header { text-align: center; margin-bottom: 25px; }
        .quiz-header h2 { color: var(--primary-color); font-size: 28px; margin-bottom: 10px; }
        .quiz-header p { color: var(--text-secondary); font-size: 16px; }
        .question-card { background: white; padding: 25px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question-text { font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 15px; }
        .answer-option { background: #f9fafb; padding: 15px; border: 2px solid #e5e7eb; border-radius: 8px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s; }
        .answer-option:hover { border-color: var(--primary-color); background: #eff6ff; }
        .answer-option.selected { border-color: var(--primary-color); background: #dbeafe; }
        .answer-option.correct { border-color: #10b981; background: #d1fae5; }
        .answer-option.incorrect { border-color: #dc2626; background: #fee2e2; }
        .btn-submit-quiz { display: block; width: 100%; max-width: 300px; margin: 20px auto; padding: 15px; background: var(--primary-color); color: white; text-align: center; border-radius: 8px; font-size: 16px; font-weight: 600; border: none; cursor: pointer; transition: background 0.2s; }
        .btn-submit-quiz:hover { background: #2563eb; }
        .btn-submit-quiz:disabled { background: #9ca3af; cursor: not-allowed; }
        .quiz-result { background: white; padding: 25px; border-radius: 8px; text-align: center; margin-top: 20px; }
        .quiz-result.pass { border: 3px solid #10b981; }
        .quiz-result.fail { border: 3px solid #dc2626; }
        .result-icon { font-size: 48px; margin-bottom: 15px; }
        .result-text { font-size: 24px; font-weight: 700; margin-bottom: 10px; }
        .result-score { font-size: 18px; color: var(--text-secondary); margin-bottom: 20px; }
        .btn-retry { padding: 12px 24px; background: #f59e0b; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: background 0.2s; }
        .btn-retry:hover { background: #d97706; }
        .btn-finish:disabled { background: #9ca3af; cursor: not-allowed; opacity: 0.6; }
        @media (max-width: 768px) { .habits-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo"><a href="index.html" style="color: inherit; text-decoration: none;">Finance<span class="logo-accent">U</span></a></div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li id="authButtons" style="opacity: 0;">
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="lesson-container">
        <a href="pillar1-lessons.html" class="back-link">‚Üê Back to Pillar 1 Lessons</a>

        <div class="lesson-header">
            <div class="lesson-number">LESSON 8</div>
            <h1>Building Good Money Habits</h1>
        </div>

        <div class="lesson-section">
            <h2>Quick Intro</h2>
            <p>Financial success isn't about one big decision‚Äîit's about hundreds of small choices made consistently over time. Good money habits compound just like interest. The small actions you take today create the financial future you'll live in tomorrow. This final lesson ties everything together and gives you the daily practices that turn knowledge into results.</p>
        </div>

        <div class="lesson-section">
            <h2>Core Concept</h2>
            <p><strong>Money habits are the automatic behaviors and routines that shape your financial life without requiring constant willpower or decision-making.</strong></p>
            <p><strong>Why Habits Matter More Than Motivation:</strong></p>
            <ul>
                <li><strong>Consistency:</strong> Motivation fades, but habits stick. You brush your teeth without thinking‚Äîthat's the power of habit.</li>
                <li><strong>Compound Effect:</strong> Small habits repeated daily create massive results over time.</li>
                <li><strong>Reduced Mental Load:</strong> Automatic good habits free up mental energy for other decisions.</li>
                <li><strong>Prevention:</strong> Good habits prevent problems before they start (like automatically saving before spending).</li>
            </ul>
            <p><strong>Key Money Habits to Build:</strong></p>
            <ul>
                <li>Check your account balances regularly (weekly)</li>
                <li>Pay yourself first (save before spending)</li>
                <li>Wait 24-48 hours before non-essential purchases</li>
                <li>Review subscriptions quarterly</li>
                <li>Track spending consistently</li>
                <li>Set aside money for goals automatically</li>
            </ul>
        </div>

        <div class="lesson-section">
            <h2>Simple Example</h2>
            <p>Meet Morgan and Sam, both earning $40,000/year:</p>
            <p><strong>Morgan's Habits (Poor):</strong></p>
            <ul>
                <li>Checks bank balance only when card declines</li>
                <li>Shops when stressed or bored</li>
                <li>Pays bills late, incurring fees</li>
                <li>Plans to save "whatever's left" (there's never anything left)</li>
                <li><strong>After 5 years:</strong> $3,000 in debt, $0 saved</li>
            </ul>
            <p><strong>Sam's Habits (Good):</strong></p>
            <ul>
                <li>Checks accounts every Sunday morning with coffee</li>
                <li>Automatically transfers $200/month to savings on payday</li>
                <li>Uses the 24-hour rule for purchases over $50</li>
                <li>Reviews spending monthly and adjusts</li>
                <li><strong>After 5 years:</strong> $0 debt, $12,000+ saved (with interest)</li>
            </ul>
            <p>Same income, completely different outcomes‚Äîall because of daily habits.</p>
        </div>

        <div class="visual-box">
            <h3>The 4 Fundamental Money Habits</h3>
            <div class="habits-grid">
                <div class="habit-card">
                    <h4 style="color: #10b981; margin-bottom: 10px;">1. Pay Yourself First</h4>
                    <p style="font-size: 14px;">Automatically move money to savings the day you get paid, before spending on anything else. Even $25/paycheck builds the habit.</p>
                </div>
                <div class="habit-card">
                    <h4 style="color: #10b981; margin-bottom: 10px;">2. The 24-Hour Rule</h4>
                    <p style="font-size: 14px;">Wait one full day before any unplanned purchase over $50. Most impulse urges fade after 24 hours.</p>
                </div>
                <div class="habit-card">
                    <h4 style="color: #10b981; margin-bottom: 10px;">3. Weekly Money Check-In</h4>
                    <p style="font-size: 14px;">Set 10 minutes every week (same day, same time) to review accounts, check balances, and note anything unusual.</p>
                </div>
                <div class="habit-card">
                    <h4 style="color: #10b981; margin-bottom: 10px;">4. Monthly Spending Review</h4>
                    <p style="font-size: 14px;">Once a month, look at where your money went. Identify surprises, cancel unused subscriptions, adjust next month's plan.</p>
                </div>
            </div>
        </div>

        <div class="lesson-section">
            <div class="mistakes-list">
                <h3>Common Mistakes to Avoid</h3>
                <ul style="margin-left: 20px;">
                    <li><strong>Trying to change everything at once:</strong> Start with ONE habit. Master it for a month, then add another.</li>
                    <li><strong>Relying on willpower:</strong> Willpower runs out. Use automation (automatic transfers, auto-pay) whenever possible.</li>
                    <li><strong>Beating yourself up over slip-ups:</strong> You'll make mistakes. Just restart the habit the next day. Progress, not perfection.</li>
                    <li><strong>Not tracking the habit:</strong> Use a calendar, app, or checklist to mark when you complete your habit. Seeing streaks motivates continuation.</li>
                    <li><strong>Picking habits that don't match your life:</strong> If you're not a morning person, don't make your habit "check finances every morning." Work with your natural rhythms.</li>
                </ul>
            </div>
        </div>

        <div class="lesson-section">
            <div class="action-box">
                <h3>üéØ Your Micro Action</h3>
                <p><strong>Pick ONE habit from this lesson to start tomorrow.</strong></p>
                <p>Choose the habit that would make the biggest difference in your life right now:</p>
                <ul>
                    <li>Need to save? Start "pay yourself first" with any amount.</li>
                    <li>Overspending? Implement the 24-hour rule.</li>
                    <li>Unsure where money goes? Start weekly check-ins.</li>
                    <li>Want to optimize? Schedule monthly spending reviews.</li>
                </ul>
                <p>Set a specific time and day. Put it in your calendar with a reminder. Do it for 30 days‚Äîthat's when it starts becoming automatic.</p>
            </div>
        </div>

        <div class="lesson-section">
            <div class="reflection-box">
                <h3>üí≠ Quick Reflection</h3>
                <p><strong>Think about this:</strong></p>
                <p>What would your financial life look like one year from now if you practiced good money habits every day? What about five years? Ten years? The difference between financial struggle and financial freedom usually isn't income‚Äîit's habits. You now have the knowledge. The only question is: will you apply it consistently?</p>
                <p style="margin-top: 15px; font-size: 14px; font-style: italic;">Consider your commitment to building these habits.</p>
            </div>
        </div>

        <!-- Lesson Quiz -->
        <div class="quiz-container" id="quizContainer">
            <div class="quiz-header">
                <h2>Lesson Quiz</h2>
                <p>Answer these questions to complete the final lesson. You need 80% (3 out of 4) to pass.</p>
            </div>
            <div id="quizQuestions"></div>
            <button class="btn-submit-quiz" id="submitQuiz" onclick="submitQuiz()">Submit Quiz</button>
            <div id="quizResult"></div>
        </div>

        <div class="completion-box">
            <h3>üéâ Congratulations!</h3>
            <p style="font-size: 18px; margin-bottom: 20px;">You've completed all 8 lessons of Pillar 1: Financial Literacy Fundamentals!</p>
            <p style="font-size: 15px; opacity: 0.9;">You've learned the foundation of money management. These concepts are the building blocks for everything else you'll learn about personal finance. Take what you've learned and put it into practice‚Äîknowledge without action changes nothing.</p>
        </div>

        <button class="btn-finish" id="finishBtn" onclick="finishLesson()" disabled>Finish Lesson & Return to Dashboard</button>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FinanceU</h4>
                    <p>Making financial literacy accessible for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="help.html">Help Center</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 10px;">Disclaimer: FinanceU provides educational content only and does not offer financial, legal, or investment advice. Always consult with a qualified professional before making financial decisions.</p>
                <p>&copy; 2025 FinanceU. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script>
        async function updateNav() {
            try {
                const response = await fetch(`${API_URL}/auth/me`, { credentials: 'include' });
                const authButtons = document.getElementById('authButtons');
                if (response.ok) {
                    authButtons.innerHTML = `<a href="dashboard.html" class="btn-primary">Dashboard</a>`;
                } else {
                    authButtons.innerHTML = `<a href="login.html" class="btn-primary">Login</a>`;
                }
            } catch (error) {
                console.log('Not logged in');
            }
        }

        const quizData = [
            {
                versions: [
                    {
                        question: "Why do habits matter more than motivation for financial success?",
                        options: [
                            "Motivation never works",
                            "Habits are easier to break",
                            "Motivation fades, but habits stick and require less willpower",
                            "Habits cost money"
                        ],
                        correct: 2
                    },
                    {
                        question: "According to the lesson, what is the main difference between habits and motivation?",
                        options: [
                            "Habits are automatic, motivation is temporary",
                            "Motivation is better than habits",
                            "They are the same thing",
                            "Habits require more energy"
                        ],
                        correct: 0
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "What is the '24-hour rule' mentioned in the lesson?",
                        options: [
                            "Work 24 hours straight",
                            "Wait one full day before any unplanned purchase over $50",
                            "Check your bank every 24 hours",
                            "Save for 24 days before buying"
                        ],
                        correct: 1
                    },
                    {
                        question: "What does 'pay yourself first' mean?",
                        options: [
                            "Give yourself a bonus",
                            "Spend on wants before needs",
                            "Automatically move money to savings before spending",
                            "Pay yourself a salary"
                        ],
                        correct: 2
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "In the example, what was the difference between Morgan and Sam after 5 years?",
                        options: [
                            "They had the same results",
                            "Morgan had $12,000 saved, Sam had debt",
                            "Sam had $12,000+ saved, Morgan had $3,000 in debt",
                            "Both were in debt"
                        ],
                        correct: 2
                    },
                    {
                        question: "Morgan and Sam earn the same $40,000/year. What made the difference in their outcomes?",
                        options: [
                            "Morgan got a better job",
                            "Daily money habits - Sam's good habits vs Morgan's poor habits",
                            "Sam won the lottery",
                            "Morgan spent less"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "What common mistake do people make when building habits?",
                        options: [
                            "Starting too slowly",
                            "Trying to change everything at once",
                            "Tracking progress",
                            "Using automation"
                        ],
                        correct: 1
                    },
                    {
                        question: "What should you do if you slip up on a financial habit?",
                        options: [
                            "Give up completely",
                            "Wait until next year",
                            "Beat yourself up about it",
                            "Just restart the habit the next day - progress over perfection"
                        ],
                        correct: 3
                    }
                ]
            }
        ];

        let currentQuestions = [];
        let userAnswers = [];
        let quizPassed = false;

        function initQuiz() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                console.error('No valid userId found');
                document.getElementById('finishBtn').disabled = true;
                return;
            }

            const quizPassedStatus = localStorage.getItem(`lesson8_quiz_passed_${userId}`);
            if (quizPassedStatus === 'true') {
                quizPassed = true;
                document.getElementById('finishBtn').disabled = false;
                document.getElementById('quizContainer').style.display = 'none';
                return;
            }
            currentQuestions = quizData.map(q => q.versions[Math.floor(Math.random() * q.versions.length)]);
            renderQuiz();
        }

        function renderQuiz() {
            const questionsContainer = document.getElementById('quizQuestions');
            questionsContainer.innerHTML = '';
            userAnswers = new Array(currentQuestions.length).fill(null);
            currentQuestions.forEach((q, qIndex) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.innerHTML = `
                    <div class="question-text">Question ${qIndex + 1}: ${q.question}</div>
                    ${q.options.map((option, oIndex) => `
                        <div class="answer-option" onclick="selectAnswer(${qIndex}, ${oIndex})">
                            <input type="radio" name="question${qIndex}" value="${oIndex}" style="margin-right: 10px;">
                            ${option}
                        </div>
                    `).join('')}
                `;
                questionsContainer.appendChild(questionCard);
            });
            document.getElementById('submitQuiz').disabled = false;
            document.getElementById('quizResult').innerHTML = '';
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;
            const questionCard = document.querySelectorAll('.question-card')[questionIndex];
            const options = questionCard.querySelectorAll('.answer-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting.');
                return;
            }
            let correct = 0;
            currentQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) correct++;
            });
            const percentage = Math.round((correct / currentQuestions.length) * 100);
            const passed = percentage >= 80;
            document.querySelectorAll('.question-card').forEach((card, qIndex) => {
                const options = card.querySelectorAll('.answer-option');
                options.forEach((opt, oIndex) => {
                    opt.style.pointerEvents = 'none';
                    if (oIndex === currentQuestions[qIndex].correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[qIndex] && oIndex !== currentQuestions[qIndex].correct) {
                        opt.classList.add('incorrect');
                    }
                });
            });
            const resultDiv = document.getElementById('quizResult');
            if (passed) {
                quizPassed = true;
                const userId = localStorage.getItem('userId');
                localStorage.setItem(`lesson8_quiz_passed_${userId}`, 'true');
                document.getElementById('finishBtn').disabled = false;
                resultDiv.innerHTML = `
                    <div class="quiz-result pass">
                        <div class="result-icon">üéâ</div>
                        <div class="result-text" style="color: #10b981;">Quiz Passed!</div>
                        <div class="result-score">You scored ${correct} out of ${currentQuestions.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary);">Great job! You can now finish the lesson and complete Pillar 1!</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="quiz-result fail">
                        <div class="result-icon">üìö</div>
                        <div class="result-text" style="color: #dc2626;">Not quite there yet</div>
                        <div class="result-score">You scored ${correct} out of ${currentQuestions.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">You need 80% to pass. Review the lesson and try again!</p>
                        <button class="btn-retry" onclick="retryQuiz()">Retry Quiz</button>
                    </div>
                `;
            }
            document.getElementById('submitQuiz').style.display = 'none';
        }

        function retryQuiz() {
            currentQuestions = quizData.map(q => q.versions[Math.floor(Math.random() * q.versions.length)]);
            renderQuiz();
            document.getElementById('submitQuiz').style.display = 'block';
        }

        function finishLesson() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                alert('Please log in to save your progress.');
                return;
            }

            if (!quizPassed) {
                alert('Please complete the quiz first!');
                return;
            }
            const completed = JSON.parse(localStorage.getItem(`pillar1_completed_${userId}`) || '[]');
            if (!completed.includes(8)) {
                completed.push(8);
                localStorage.setItem(`pillar1_completed_${userId}`, JSON.stringify(completed));
            }
            window.location.href = 'pillar1-lessons.html';
        }

        updateNav();
        initQuiz();
    </script>
</body>
</html>
