<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Money Story - Path 2 Lesson 1 - FinanceU</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: #0f0f0f;
            color: #d1d5db;
            overflow-x: hidden;
        }

        .lesson-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 30px 20px 80px;
        }

        /* Hero Header with Animation */
        .lesson-header {
            text-align: center;
            margin-bottom: 40px;
            margin-top: 100px;
            padding: 40px 25px;
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(34, 197, 94, 0.3);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .lesson-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(34, 197, 94, 0.15) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .lesson-header h1 {
            font-size: clamp(28px, 5vw, 42px);
            color: white;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            font-weight: 900;
        }

        .lesson-number {
            color: rgba(255, 255, 255, 0.9);
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .lesson-tagline {
            color: rgba(255, 255, 255, 0.85);
            font-size: 18px;
            position: relative;
            z-index: 1;
            font-style: italic;
        }

        /* Screen System */
        .lesson-screen {
            display: none;
        }

        .lesson-screen.active {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .screen-progress {
            text-align: center;
            margin-bottom: 25px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #E0F2FE 0%, #BAE6FD 100%);
            border-radius: 12px;
            font-weight: 700;
            color: #0284C7;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        /* Content Cards */
        .content-card {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.05) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(34, 197, 94, 0.2);
            padding: 35px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .content-card:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.7);
            transform: translateY(-2px);
            border-color: rgba(34, 197, 94, 0.4);
        }

        .content-card h2 {
            color: #e5e7eb;
            font-size: 28px;
            margin-bottom: 20px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .content-card p {
            line-height: 1.8;
            color: #9ca3af;
            font-size: 16px;
            margin-bottom: 15px;
        }

        /* Story Cards - Interactive Journey */
        .story-choice-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .story-choice {
            background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%);
            border: 3px solid #BAE6FD;
            border-radius: 16px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .story-choice:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: #00A676;
            box-shadow: 0 10px 30px rgba(0, 166, 118, 0.2);
        }

        .story-choice.selected {
            background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
            border-color: #00A676;
            box-shadow: 0 10px 30px rgba(0, 166, 118, 0.3);
        }

        .story-icon {
            font-size: 56px;
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .story-choice h3 {
            font-size: 20px;
            font-weight: 700;
            color: #0A1A2F;
            margin-bottom: 10px;
        }

        .story-choice p {
            font-size: 14px;
            color: #6B7280;
            margin: 0;
        }

        /* Interactive Budget Builder */
        .budget-builder {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border-radius: 16px;
            padding: 30px;
            margin: 25px 0;
            border: 3px solid #F59E0B;
        }

        .budget-builder h3 {
            color: #92400E;
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: 800;
            text-align: center;
        }

        .budget-input-row {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
        }

        .budget-input-row:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
        }

        .budget-emoji {
            font-size: 36px;
            min-width: 50px;
            text-align: center;
        }

        .budget-label {
            flex: 1;
        }

        .budget-label-title {
            font-weight: 700;
            color: #1F2937;
            font-size: 16px;
            margin-bottom: 4px;
        }

        .budget-label-hint {
            font-size: 13px;
            color: #9CA3AF;
        }

        .budget-input-wrapper {
            position: relative;
            width: 140px;
        }

        .budget-input-wrapper::before {
            content: '$';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            font-weight: 700;
            color: #F59E0B;
        }

        .budget-input {
            width: 100%;
            padding: 12px 15px 12px 35px;
            border: 2px solid #FCD34D;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 700;
            text-align: right;
            background: #FFFBEB;
            color: #92400E;
            transition: all 0.2s ease;
        }

        .budget-input:focus {
            outline: none;
            border-color: #F59E0B;
            box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.1);
        }

        /* Results Visualization */
        .results-container {
            display: none;
            animation: fadeIn 0.8s ease;
        }

        .results-container.visible {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .money-meter {
            background: linear-gradient(135deg, #1E293B 0%, #334155 100%);
            border-radius: 16px;
            padding: 35px;
            margin: 25px 0;
            color: white;
        }

        .meter-title {
            text-align: center;
            font-size: 24px;
            font-weight: 800;
            margin-bottom: 30px;
        }

        .meter-bar-container {
            margin-bottom: 20px;
        }

        .meter-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .meter-bar {
            height: 45px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            overflow: hidden;
            position: relative;
        }

        .meter-fill {
            height: 100%;
            background: linear-gradient(90deg, #10B981 0%, #059669 100%);
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 20px;
            font-weight: 700;
            font-size: 16px;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0;
        }

        .meter-fill.expense {
            background: linear-gradient(90deg, #EF4444 0%, #DC2626 100%);
        }

        /* Insight Cards */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .insight-card {
            padding: 25px;
            border-radius: 16px;
            border: 3px solid;
            animation: popIn 0.6s ease both;
            position: relative;
            overflow: hidden;
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .insight-card.positive {
            background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
            border-color: #10B981;
        }

        .insight-card.warning {
            background: linear-gradient(135deg, #FED7AA 0%, #FDBA74 100%);
            border-color: #F97316;
        }

        .insight-card.danger {
            background: linear-gradient(135deg, #FECACA 0%, #FCA5A5 100%);
            border-color: #EF4444;
        }

        .insight-icon {
            font-size: 40px;
            margin-bottom: 12px;
        }

        .insight-title {
            font-size: 18px;
            font-weight: 800;
            margin-bottom: 10px;
            color: #1F2937;
        }

        .insight-text {
            font-size: 14px;
            line-height: 1.6;
            color: #4B5563;
        }

        /* Navigation Buttons */
        .screen-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 2px solid rgba(75, 85, 99, 0.4);
        }

        .btn-nav {
            padding: 14px 28px;
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .btn-nav:hover {
            background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(156, 163, 175, 0.4);
        }

        .btn-nav:disabled {
            background: #374151;
            cursor: not-allowed;
            transform: none;
            opacity: 0.5;
        }

        .btn-nav.btn-prev {
            background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
        }

        .btn-nav.btn-prev:hover {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }

        .nav-spacer {
            width: 140px;
        }

        /* Quiz Styles */
        .quiz-container {
            background: linear-gradient(135deg, #EDE9FE 0%, #DDD6FE 100%);
            border: 3px solid #A78BFA;
            border-radius: 16px;
            padding: 35px;
            margin: 30px 0;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .quiz-header h2 {
            color: #5B21B6;
            font-size: 32px;
            margin-bottom: 12px;
            font-weight: 900;
        }

        .quiz-header p {
            color: #6B7280;
            font-size: 16px;
        }

        .question-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .question-text {
            font-size: 18px;
            font-weight: 700;
            color: #1F2937;
            margin-bottom: 18px;
        }

        .answer-option {
            background: #F9FAFB;
            padding: 16px 20px;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .answer-option:hover {
            border-color: #A78BFA;
            background: #F5F3FF;
            transform: translateX(5px);
        }

        .answer-option.selected {
            border-color: #8B5CF6;
            background: #EDE9FE;
        }

        .answer-option.correct {
            border-color: #10B981;
            background: #D1FAE5;
        }

        .answer-option.incorrect {
            border-color: #EF4444;
            background: #FEE2E2;
        }

        .btn-submit-quiz {
            display: block;
            width: 100%;
            max-width: 350px;
            margin: 25px auto;
            padding: 16px;
            background: #8B5CF6;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-submit-quiz:hover {
            background: #7C3AED;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .quiz-result {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin-top: 25px;
            display: none;
        }

        .quiz-result.visible {
            display: block;
            animation: popIn 0.5s ease;
        }

        .quiz-result.pass {
            border: 3px solid #10B981;
        }

        .quiz-result.fail {
            border: 3px solid #EF4444;
        }

        .result-icon {
            font-size: 64px;
            margin-bottom: 15px;
        }

        .result-text {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .result-score {
            font-size: 18px;
            color: #6B7280;
            margin-bottom: 20px;
        }

        .btn-finish {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 35px auto;
            padding: 18px;
            background: linear-gradient(135deg, #00A676 0%, #10B981 100%);
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 700;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 166, 118, 0.3);
        }

        .btn-finish:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 166, 118, 0.4);
        }

        .btn-finish:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
            opacity: 0.6;
            transform: none;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #9ca3af;
            text-decoration: none;
            font-weight: 700;
            transition: all 0.2s ease;
        }

        .back-link:hover {
            color: #e5e7eb;
            transform: translateX(-3px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .lesson-container {
                padding: 20px 16px 60px;
            }

            .content-card {
                padding: 25px 20px;
            }

            .story-choice-grid {
                grid-template-columns: 1fr;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            .budget-input-row {
                flex-direction: column;
                align-items: flex-start;
            }

            .budget-input-wrapper {
                width: 100%;
            }

            .screen-navigation {
                flex-direction: column;
            }

            .nav-spacer {
                display: none;
            }

            .btn-nav {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body class="min-h-screen relative" style="color: #d1d5db;">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50" style="backdrop-filter: blur(12px); background: rgba(15, 15, 15, 0.9); border-bottom: 1px solid rgba(156, 163, 175, 0.15); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="/" class="flex items-center space-x-2">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-gray-200 to-gray-400 flex items-center justify-center font-bold text-xl" style="color: #1f2937; box-shadow: 0 0 20px rgba(156, 163, 175, 0.4);">
                        F
                    </div>
                    <span class="text-2xl font-bold" style="background: linear-gradient(135deg, #e5e7eb 0%, #9ca3af 50%, #e5e7eb 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">FinanceU</span>
                </a>

                <div class="hidden md:flex items-center space-x-6">
                    <a href="/dashboard" class="text-gray-400 hover:text-gray-200 transition-colors font-medium">Dashboard</a>
                </div>

                <div class="flex items-center space-x-4">
                    <button onclick="logout()" class="px-6 py-2.5 bg-gradient-to-r from-gray-200 to-gray-300 hover:from-gray-300 hover:to-gray-200 rounded-lg font-semibold transition-all" style="color: #1f2937; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), 0 0 20px rgba(156, 163, 175, 0.4);">
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="lesson-container">
        <a href="/path2-lessons" class="back-link">‚Üê Back to Path 2 Lessons</a>

        <!-- Lesson Header -->
        <div class="lesson-header">
            <div class="lesson-number">PATH 2: BUDGETING & SAVING ‚Ä¢ LESSON 1</div>
            <h1>üìñ Your Money Story</h1>
            <p class="lesson-tagline">Discover where your money goes and write a better ending</p>
        </div>

        <!-- Screen 1: The Wake Up Call -->
        <div class="lesson-screen active" data-screen="1">
            <div class="screen-progress">Chapter 1 of 7 ‚Ä¢ The Wake Up Call</div>

            <div class="content-card">
                <h2>üí≠ Let's Start With a Question</h2>
                <p>You're at the coffee shop. The barista says "$5.25" and you tap your card without thinking. It's just coffee, right?</p>
                <p>But here's the thing: if you do this every workday, that's <strong>$1,365 per year</strong>. Almost enough for a vacation. Or two months of groceries. Or...</p>
                <p style="font-size: 20px; font-weight: 700; color: #0A1A2F; margin-top: 25px;">When was the last time you knew EXACTLY where your money went?</p>
            </div>

            <div class="content-card">
                <h2>üéØ What You'll Learn Today</h2>
                <div class="story-choice-grid">
                    <div class="story-choice" style="pointer-events: none;">
                        <div class="story-icon">üîç</div>
                        <h3>Track Reality</h3>
                        <p>See where every dollar actually goes</p>
                    </div>
                    <div class="story-choice" style="pointer-events: none;">
                        <div class="story-icon">üí°</div>
                        <h3>Find Patterns</h3>
                        <p>Discover your money habits</p>
                    </div>
                    <div class="story-choice" style="pointer-events: none;">
                        <div class="story-icon">üé®</div>
                        <h3>Design Change</h3>
                        <p>Build your first simple budget</p>
                    </div>
                </div>
            </div>

            <div class="screen-navigation">
                <div class="nav-spacer"></div>
                <button class="btn-nav" onclick="nextScreen()">Begin Your Story ‚Üí</button>
            </div>
        </div>

        <!-- Screen 2: Choose Your Character -->
        <div class="lesson-screen" data-screen="2">
            <div class="screen-progress">Chapter 2 of 7 ‚Ä¢ Your Money Personality</div>

            <div class="content-card">
                <h2>ü§î Which One Are You?</h2>
                <p>Everyone has a money story. Which character sounds most like you?</p>

                <div class="story-choice-grid">
                    <div class="story-choice" onclick="selectCharacter(this, 'spender')">
                        <div class="story-icon">üõçÔ∏è</div>
                        <h3>The Spender</h3>
                        <p>"I work hard, I deserve to enjoy it! Money is for spending, not hoarding."</p>
                    </div>
                    <div class="story-choice" onclick="selectCharacter(this, 'saver')">
                        <div class="story-icon">üè¶</div>
                        <h3>The Saver</h3>
                        <p>"Every penny counts! I track everything and hate wasting money."</p>
                    </div>
                    <div class="story-choice" onclick="selectCharacter(this, 'avoider')">
                        <div class="story-icon">üôà</div>
                        <h3>The Avoider</h3>
                        <p>"I don't want to know. Checking my account gives me anxiety."</p>
                    </div>
                    <div class="story-choice" onclick="selectCharacter(this, 'confused')">
                        <div class="story-icon">‚ùì</div>
                        <h3>The Confused</h3>
                        <p>"Where did it all go? I had money last week, I swear!"</p>
                    </div>
                </div>

                <div id="characterFeedback" style="margin-top: 25px; padding: 20px; background: #F0F9FF; border-radius: 12px; display: none;">
                    <p style="font-weight: 700; color: #0284C7; margin-bottom: 10px;">Great choice! Here's the truth:</p>
                    <p id="characterMessage" style="color: #4B5563;"></p>
                </div>
            </div>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()">‚Üê Previous</button>
                <button class="btn-nav" id="continueBtn2" onclick="nextScreen()" disabled>Continue ‚Üí</button>
            </div>
        </div>

        <!-- Screen 3: The Reality Check -->
        <div class="lesson-screen" data-screen="3">
            <div class="screen-progress">Chapter 3 of 7 ‚Ä¢ The Numbers Don't Lie</div>

            <div class="content-card">
                <h2>üìä Here's What Most People Think</h2>
                <p>Studies show people are terrible at estimating their own spending:</p>
                <div style="background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%); padding: 20px; border-radius: 12px; margin: 20px 0; border-left: 4px solid #EF4444;">
                    <p style="font-size: 18px; font-weight: 700; color: #991B1B; margin-bottom: 10px;">The Average Person:</p>
                    <p style="color: #7F1D1D;">‚Ä¢ Underestimates dining out by <strong>40%</strong></p>
                    <p style="color: #7F1D1D;">‚Ä¢ Forgets about subscriptions worth <strong>$200/month</strong></p>
                    <p style="color: #7F1D1D;">‚Ä¢ Has <strong>$300-500</strong> in "mystery spending" they can't explain</p>
                </div>
            </div>

            <div class="content-card">
                <h2>üéØ Let's Find YOUR Reality</h2>
                <p>Don't worry - this is just for you. No judgment, no shame. Just truth.</p>
                <p style="font-weight: 700; color: #00A676; font-size: 18px;">Ready to build your first budget tracker?</p>
            </div>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()">‚Üê Previous</button>
                <button class="btn-nav" onclick="nextScreen()">I'm Ready ‚Üí</button>
            </div>
        </div>

        <!-- Screen 4: Build Your Budget -->
        <div class="lesson-screen" data-screen="4">
            <div class="screen-progress">Chapter 4 of 7 ‚Ä¢ Track Your Money</div>

            <div class="content-card">
                <h2>üí∞ Step 1: How Much Comes In?</h2>
                <p>Start with your monthly take-home pay (after taxes). Include everything - job, side gigs, allowance.</p>

                <div style="background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%); padding: 25px; border-radius: 12px; margin: 20px 0;">
                    <label style="display: block; font-weight: 700; color: #065F46; margin-bottom: 12px; font-size: 18px;">Your Monthly Income</label>
                    <div style="position: relative;">
                        <span style="position: absolute; left: 20px; top: 50%; transform: translateY(-50%); font-size: 32px; font-weight: 700; color: #059669;">$</span>
                        <input type="number" id="monthlyIncome" placeholder="0" min="0" step="100"
                            style="width: 100%; padding: 20px 20px 20px 60px; border: 3px solid #10B981; border-radius: 12px; font-size: 36px; font-weight: 800; color: #065F46; background: white;"
                            oninput="enableNext()">
                    </div>
                </div>
            </div>

            <div class="content-card">
                <h2>üí∏ Step 2: Where Does It Go?</h2>
                <p>Now the fun part. Enter your <strong>monthly</strong> spending in each category. Be honest!</p>

                <div class="budget-builder">
                    <h3>Your Monthly Expenses</h3>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üè†</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Housing</div>
                            <div class="budget-label-hint">Rent, mortgage, utilities</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="housing" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üçï</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Food & Dining</div>
                            <div class="budget-label-hint">Groceries, restaurants, takeout</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="food" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üöó</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Transportation</div>
                            <div class="budget-label-hint">Car, gas, insurance, Uber</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="transport" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üì±</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Phone & Internet</div>
                            <div class="budget-label-hint">Phone bill, internet, streaming</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="tech" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üéÆ</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Entertainment</div>
                            <div class="budget-label-hint">Netflix, games, hobbies</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="entertainment" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üõí</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Shopping</div>
                            <div class="budget-label-hint">Clothes, Amazon, random stuff</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="shopping" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">üíä</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Health & Fitness</div>
                            <div class="budget-label-hint">Gym, doctors, medications</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="health" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>

                    <div class="budget-input-row">
                        <div class="budget-emoji">‚ö°</div>
                        <div class="budget-label">
                            <div class="budget-label-title">Other Expenses</div>
                            <div class="budget-label-hint">Everything else</div>
                        </div>
                        <div class="budget-input-wrapper">
                            <input type="number" class="budget-input expense-input" data-category="other" placeholder="0" min="0" oninput="calculateTotal()">
                        </div>
                    </div>
                </div>
            </div>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()">‚Üê Previous</button>
                <button class="btn-nav" id="continueBtn4" onclick="showResults()">See My Results ‚Üí</button>
            </div>
        </div>

        <!-- Screen 5: The Truth Revealed -->
        <div class="lesson-screen" data-screen="5">
            <div class="screen-progress">Chapter 5 of 7 ‚Ä¢ Your Money Reality</div>

            <div class="content-card">
                <h2>üìà Here's Your Money Story</h2>
                <p>Time to face the music. But remember: awareness is the first step to control.</p>

                <div class="results-container" id="resultsContainer">
                    <div class="money-meter">
                        <div class="meter-title">Your Monthly Money Flow</div>

                        <div class="meter-bar-container">
                            <div class="meter-label">
                                <span>üí∞ Money In</span>
                                <span id="incomeDisplay">$0</span>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-fill" id="incomeMeter"></div>
                            </div>
                        </div>

                        <div class="meter-bar-container">
                            <div class="meter-label">
                                <span>üí∏ Money Out</span>
                                <span id="expenseDisplay">$0</span>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-fill expense" id="expenseMeter"></div>
                            </div>
                        </div>

                        <div class="meter-bar-container">
                            <div class="meter-label">
                                <span>‚ú® Left Over</span>
                                <span id="leftoverDisplay">$0</span>
                            </div>
                            <div class="meter-bar">
                                <div class="meter-fill" id="leftoverMeter"></div>
                            </div>
                        </div>
                    </div>

                    <div class="insights-grid" id="insightsContainer">
                        <!-- Dynamic insights will appear here -->
                    </div>
                </div>
            </div>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()">‚Üê Adjust Numbers</button>
                <button class="btn-nav" onclick="nextScreen()">What Now? ‚Üí</button>
            </div>
        </div>

        <!-- Screen 6: The Transformation -->
        <div class="lesson-screen" data-screen="6">
            <div class="screen-progress">Chapter 6 of 7 ‚Ä¢ Your Action Plan</div>

            <div class="content-card">
                <h2>üéØ What You Just Learned</h2>
                <div style="background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%); padding: 25px; border-radius: 12px; margin: 20px 0; border-left: 4px solid #10B981;">
                    <p style="font-size: 18px; font-weight: 700; color: #065F46; margin-bottom: 15px;">Congratulations! You just did something 80% of people never do:</p>
                    <p style="color: #047857;">‚úÖ You faced your numbers honestly</p>
                    <p style="color: #047857;">‚úÖ You identified where your money goes</p>
                    <p style="color: #047857;">‚úÖ You saw your spending patterns</p>
                    <p style="color: #047857;">‚úÖ You took control of your financial story</p>
                </div>
            </div>

            <div class="content-card">
                <h2>üöÄ Your Next Steps</h2>
                <p>Here's what happens now:</p>
                <div class="story-choice-grid">
                    <div class="story-choice" style="pointer-events: none;">
                        <div class="story-icon">üìù</div>
                        <h3>Track Weekly</h3>
                        <p>Review your spending once a week for a month</p>
                    </div>
                    <div class="story-choice" style="pointer-events: none;">
                        <div class="story-icon">üîç</div>
                        <h3>Find Leaks</h3>
                        <p>Spot the expenses you can easily reduce</p>
                    </div>
                    <div class="story-choice" style="pointer-events: none;">
                        <div class="story-icon">üí™</div>
                        <h3>Build Better</h3>
                        <p>Create a realistic budget that actually works</p>
                    </div>
                </div>
            </div>

            <div class="content-card">
                <h2>üí° Pro Tip</h2>
                <p style="font-size: 18px; font-weight: 600; color: #0A1A2F;">Small changes compound. Cutting just $10/day saves $3,650/year. That's a decent vacation, an emergency fund, or a massive head start on your goals.</p>
            </div>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()">‚Üê Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Take the Quiz ‚Üí</button>
            </div>
        </div>

        <!-- Screen 7: Quiz Time -->
        <div class="lesson-screen" data-screen="7">
            <div class="screen-progress">Chapter 7 of 7 ‚Ä¢ Test Your Knowledge</div>

            <div class="quiz-container">
                <div class="quiz-header">
                    <h2>‚úÖ Knowledge Check</h2>
                    <p>Answer these questions to complete the lesson. You need 100% to unlock the next lesson!</p>
                </div>

                <div id="quizQuestions"></div>

                <button class="btn-submit-quiz" id="submitQuiz" onclick="submitQuiz()">Submit Answers</button>

                <div class="quiz-result" id="quizResult"></div>
            </div>

            <button class="btn-finish" id="finishBtn" onclick="finishLesson()" disabled>Complete Lesson & Continue ‚Üí</button>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()">‚Üê Previous</button>
                <div class="nav-spacer"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FinanceU</h4>
                    <p>Making financial literacy accessible for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/careers">Careers</a></li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="/help">Help Center</a></li>
                        <li><a href="/privacy">Privacy Policy</a></li>
                        <li><a href="/terms">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 10px;">Disclaimer: FinanceU provides educational content only and does not offer financial, legal, or investment advice. Always consult with a qualified professional before making financial decisions.</p>
                <p>&copy; 2025 FinanceU. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script src="lesson-completion.js"></script>
    <script>
        // Authentication
        async function updateNav() {
            const authButtons = document.getElementById('authButtons');
            const cachedAuth = localStorage.getItem('authState');
            if (cachedAuth) {
                const authState = JSON.parse(cachedAuth);
                authButtons.innerHTML = authState.isLoggedIn
                    ? `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`
                    : `<a href="login" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }

            try {
                const response = await fetch(`${API_URL}/auth/me`, { credentials: 'include' });
                if (response.ok) {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: true }));
                    authButtons.innerHTML = `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`;
                } else {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                    authButtons.innerHTML = `<a href="login" class="btn-primary">Login</a>`;
                }
                authButtons.style.opacity = '1';
            } catch (error) {
                localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                authButtons.innerHTML = `<a href="login" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }
        }

        async function logout() {
            localStorage.removeItem('authState');
            localStorage.removeItem('token');
            localStorage.removeItem('userId');
            try {
                await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/index.html';
            } catch (error) {
                window.location.href = '/index.html';
            }
        }

        // Screen Navigation
        let currentScreen = 1;
        const totalScreens = 7;

        function showScreen(screenNumber) {
            document.querySelectorAll('.lesson-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            const targetScreen = document.querySelector(`.lesson-screen[data-screen="${screenNumber}"]`);
            if (targetScreen) {
                targetScreen.classList.add('active');
                currentScreen = screenNumber;

                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
        }

        function nextScreen() {
            if (currentScreen < totalScreens) {
                showScreen(currentScreen + 1);
            }
        }

        function previousScreen() {
            if (currentScreen > 1) {
                showScreen(currentScreen - 1);
            }
        }

        // Character Selection
        let selectedCharacter = null;
        const characterMessages = {
            spender: "Every personality can build wealth. The key is being aware of your tendencies. As a spender, you'll learn to enjoy AND save.",
            saver: "Being careful is great! But remember: life is meant to be lived. You'll learn to balance saving with enjoying the journey.",
            avoider: "You're not alone. Money anxiety is real. This lesson will make facing your finances feel safe and empowering.",
            confused: "That feeling ends today. You're about to gain crystal-clear clarity on exactly where your money goes."
        };

        function selectCharacter(element, character) {
            document.querySelectorAll('.story-choice').forEach(choice => {
                choice.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedCharacter = character;

            const feedback = document.getElementById('characterFeedback');
            const message = document.getElementById('characterMessage');
            message.textContent = characterMessages[character];
            feedback.style.display = 'block';

            document.getElementById('continueBtn2').disabled = false;
        }

        // Budget Tracking
        let monthlyIncome = 0;
        let expenses = {};

        function enableNext() {
            monthlyIncome = parseFloat(document.getElementById('monthlyIncome').value) || 0;
        }

        function calculateTotal() {
            const inputs = document.querySelectorAll('.expense-input');
            expenses = {};
            inputs.forEach(input => {
                const category = input.dataset.category;
                const value = parseFloat(input.value) || 0;
                expenses[category] = value;
            });
        }

        function showResults() {
            calculateTotal();
            const income = parseFloat(document.getElementById('monthlyIncome').value) || 0;

            if (income === 0) {
                alert('Please enter your monthly income first!');
                showScreen(4);
                return;
            }

            nextScreen();

            const totalExpenses = Object.values(expenses).reduce((sum, val) => sum + val, 0);
            const leftover = income - totalExpenses;
            const percentSpent = income > 0 ? (totalExpenses / income) * 100 : 0;

            // Animate meters
            setTimeout(() => {
                document.getElementById('resultsContainer').classList.add('visible');

                document.getElementById('incomeDisplay').textContent = `$${income.toFixed(0)}`;
                document.getElementById('incomeMeter').style.width = '100%';
                document.getElementById('incomeMeter').textContent = '100%';

                const expensePercent = Math.min((totalExpenses / income) * 100, 100);
                document.getElementById('expenseDisplay').textContent = `$${totalExpenses.toFixed(0)}`;
                document.getElementById('expenseMeter').style.width = expensePercent + '%';
                document.getElementById('expenseMeter').textContent = expensePercent.toFixed(0) + '%';

                const leftoverPercent = Math.max(0, (leftover / income) * 100);
                document.getElementById('leftoverDisplay').textContent = `$${Math.max(0, leftover).toFixed(0)}`;
                document.getElementById('leftoverMeter').style.width = leftoverPercent + '%';
                document.getElementById('leftoverMeter').textContent = leftoverPercent.toFixed(0) + '%';

                generateInsights(income, totalExpenses, leftover, percentSpent);
            }, 300);
        }

        function generateInsights(income, totalExpenses, leftover, percentSpent) {
            const insights = [];

            if (leftover < 0) {
                insights.push({
                    type: 'danger',
                    icon: 'üö®',
                    title: 'Critical: Spending More Than You Earn',
                    text: `You're overspending by $${Math.abs(leftover).toFixed(0)} per month. This leads to debt. We need to fix this.`
                });
            } else if (leftover === 0) {
                insights.push({
                    type: 'warning',
                    icon: '‚ö†Ô∏è',
                    title: 'Living Paycheck to Paycheck',
                    text: 'You have zero buffer. One emergency and you\'re in trouble. Let\'s build that safety net.'
                });
            } else if (leftover < income * 0.1) {
                insights.push({
                    type: 'warning',
                    icon: 'üò∞',
                    title: 'Tight Budget',
                    text: `Only $${leftover.toFixed(0)} left (${((leftover/income)*100).toFixed(0)}%). You need a bigger cushion. Aim for 10-20%.`
                });
            } else {
                insights.push({
                    type: 'positive',
                    icon: 'üéâ',
                    title: 'Great Job!',
                    text: `You have $${leftover.toFixed(0)} left over (${((leftover/income)*100).toFixed(0)}%). You're doing better than most people!`
                });
            }

            const sortedExpenses = Object.entries(expenses).sort((a, b) => b[1] - a[1]);
            if (sortedExpenses.length > 0 && sortedExpenses[0][1] > 0) {
                const categoryNames = {
                    housing: 'Housing',
                    food: 'Food & Dining',
                    transport: 'Transportation',
                    tech: 'Phone & Internet',
                    entertainment: 'Entertainment',
                    shopping: 'Shopping',
                    health: 'Health & Fitness',
                    other: 'Other'
                };
                const biggestCategory = categoryNames[sortedExpenses[0][0]];
                const biggestAmount = sortedExpenses[0][1];
                const biggestPercent = (biggestAmount / income * 100).toFixed(0);

                insights.push({
                    type: 'warning',
                    icon: 'üîç',
                    title: `Biggest Expense: ${biggestCategory}`,
                    text: `You spend $${biggestAmount.toFixed(0)}/month here (${biggestPercent}% of income). Is there room to optimize?`
                });
            }

            insights.push({
                type: 'positive',
                icon: 'üí°',
                title: 'You\'re Ahead of the Game',
                text: 'Most people never track their spending. By doing this, you\'re already in the top 20%. Knowledge is power.'
            });

            const container = document.getElementById('insightsContainer');
            container.innerHTML = '';
            insights.forEach((insight, index) => {
                const card = document.createElement('div');
                card.className = `insight-card ${insight.type}`;
                card.style.animationDelay = `${index * 0.15}s`;
                card.innerHTML = `
                    <div class="insight-icon">${insight.icon}</div>
                    <div class="insight-title">${insight.title}</div>
                    <div class="insight-text">${insight.text}</div>
                `;
                container.appendChild(card);
            });
        }

        // Quiz
        const quizData = [
            {
                versions: [
                    {
                        question: "What is the main purpose of tracking your expenses?",
                        options: [
                            "To feel guilty about spending",
                            "To understand where your money goes",
                            "To impress your friends",
                            "To avoid paying taxes"
                        ],
                        correct: 1
                    },
                    {
                        question: "Why do most people underestimate their spending?",
                        options: [
                            "They intentionally lie",
                            "Small purchases add up without being noticed",
                            "They don't care about money",
                            "Banks hide transactions"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "If your expenses exceed your income, what should you do?",
                        options: [
                            "Ignore it and hope it gets better",
                            "Cut expenses or increase income",
                            "Take out more loans",
                            "Stop tracking altogether"
                        ],
                        correct: 1
                    },
                    {
                        question: "What does it mean to 'live paycheck to paycheck'?",
                        options: [
                            "You save most of your income",
                            "You have no money left over after expenses",
                            "You invest regularly",
                            "You have multiple income sources"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "Which is a 'need' vs a 'want'?",
                        options: [
                            "Netflix is a need",
                            "Basic groceries are a need",
                            "Designer clothes are a need",
                            "Video games are a need"
                        ],
                        correct: 1
                    },
                    {
                        question: "What's the best way to categorize expenses?",
                        options: [
                            "Don't categorize, just spend freely",
                            "Group similar expenses together",
                            "Put everything in 'miscellaneous'",
                            "Only track big purchases"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "What percentage of people regularly track their spending?",
                        options: [
                            "Around 80%",
                            "Around 20%",
                            "Almost everyone",
                            "Nobody does"
                        ],
                        correct: 1
                    },
                    {
                        question: "How often should you review your budget?",
                        options: [
                            "Once a year",
                            "Weekly or monthly",
                            "Never, set it and forget it",
                            "Only when you overspend"
                        ],
                        correct: 1
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "What's a realistic first step after tracking expenses?",
                        options: [
                            "Cut all spending immediately",
                            "Find one small expense to reduce",
                            "Quit your job to save money",
                            "Ignore the results"
                        ],
                        correct: 1
                    },
                    {
                        question: "Saving $10 per day equals how much per year?",
                        options: [
                            "$365",
                            "$3,650",
                            "$1,000",
                            "$10,000"
                        ],
                        correct: 1
                    }
                ]
            }
        ];

        let currentQuestions = [];
        let userAnswers = [];
        let quizPassed = false;

        function initQuiz() {
            const userId = localStorage.getItem('userId');

            if (!userId || userId === 'null' || userId === 'undefined') {
                document.getElementById('finishBtn').disabled = true;
                return;
            }

            const quizPassedStatus = localStorage.getItem(`path2_lesson1_quiz_passed_${userId}`);

            if (quizPassedStatus === 'true') {
                quizPassed = true;
                document.getElementById('finishBtn').disabled = false;
                document.getElementById('submitQuiz').style.display = 'none';
                document.getElementById('quizResult').innerHTML = `
                    <div class="quiz-result pass visible">
                        <div class="result-icon">‚úÖ</div>
                        <div class="result-text" style="color: #10B981;">Already Completed!</div>
                        <div class="result-score">You've already passed this quiz. Click below to finish the lesson.</div>
                    </div>
                `;
                document.getElementById('quizResult').style.display = 'block';
                return;
            }

            currentQuestions = quizData.map(q => {
                const randomVersion = q.versions[Math.floor(Math.random() * q.versions.length)];
                return randomVersion;
            });

            renderQuiz();
        }

        function renderQuiz() {
            const container = document.getElementById('quizQuestions');
            container.innerHTML = '';
            userAnswers = new Array(currentQuestions.length).fill(null);

            currentQuestions.forEach((q, qIndex) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `
                    <div class="question-text">Question ${qIndex + 1}: ${q.question}</div>
                    ${q.options.map((option, oIndex) => `
                        <div class="answer-option" onclick="selectAnswer(${qIndex}, ${oIndex})">
                            <input type="radio" name="question${qIndex}" value="${oIndex}">
                            ${option}
                        </div>
                    `).join('')}
                `;
                container.appendChild(card);
            });

            document.getElementById('submitQuiz').style.display = 'block';
            document.getElementById('quizResult').innerHTML = '';
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            const questionCard = document.querySelectorAll('.question-card')[questionIndex];
            const options = questionCard.querySelectorAll('.answer-option');

            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            currentQuestions.forEach((q, index) => {
                const options = document.querySelectorAll('.question-card')[index].querySelectorAll('.answer-option');
                options.forEach((opt, oIndex) => {
                    opt.style.pointerEvents = 'none';
                    if (oIndex === q.correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[index] && oIndex !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });

                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = Math.round((correct / currentQuestions.length) * 100);
            const passed = percentage === 100;

            document.getElementById('submitQuiz').style.display = 'none';

            const resultDiv = document.getElementById('quizResult');
            resultDiv.className = `quiz-result visible ${passed ? 'pass' : 'fail'}`;

            if (passed) {
                quizPassed = true;
                const userId = localStorage.getItem('userId');
                localStorage.setItem(`path2_lesson1_quiz_passed_${userId}`, 'true');

                resultDiv.innerHTML = `
                    <div class="result-icon">üéâ</div>
                    <div class="result-text" style="color: #10B981;">Perfect Score!</div>
                    <div class="result-score">You got ${correct} out of ${currentQuestions.length} correct!</div>
                    <p style="color: #6B7280;">Amazing work! You're ready to move forward.</p>
                `;

                document.getElementById('finishBtn').disabled = false;
            } else {
                resultDiv.innerHTML = `
                    <div class="result-icon">üìö</div>
                    <div class="result-text" style="color: #EF4444;">Not Quite There</div>
                    <div class="result-score">You got ${correct} out of ${currentQuestions.length} correct</div>
                    <p style="color: #6B7280; margin-bottom: 15px;">You need 100% to pass. Review the lesson and try again!</p>
                    <button class="btn-nav" onclick="retryQuiz()" style="margin: 0 auto;">Try Again</button>
                `;
            }
        }

        function retryQuiz() {
            currentQuestions = quizData.map(q => {
                const randomVersion = q.versions[Math.floor(Math.random() * q.versions.length)];
                return randomVersion;
            });
            renderQuiz();
        }

        async function finishLesson() {
            if (!quizPassed) {
                alert('Please pass the quiz first!');
                return;
            }

            const userId = localStorage.getItem('userId');
            if (!userId || userId === 'null' || userId === 'undefined') {
                alert('Please log in to save your progress.');
                window.location.href = '/login.html';
                return;
            }

            const success = await completeLesson('path2_lesson1', 2, 1);

            if (success) {
                window.location.href = '/path2-lessons.html';
            }
        }

        // Initialize
        updateNav();
        initQuiz();
    </script>
</body>
</html>
