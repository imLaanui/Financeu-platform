<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 1 - What is Money? - FinanceU</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .lesson-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        .lesson-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #EFF6FF 0%, #DBEAFE 100%);
            border-radius: 16px;
            position: relative;
            overflow: hidden;
        }
        .lesson-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .lesson-header h1 {
            font-size: 36px;
            color: var(--text-primary);
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        .lesson-header .lesson-number {
            color: var(--primary-color);
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .lesson-section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        .lesson-section:hover {
            border-left-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .lesson-section h2 {
            color: var(--primary-color);
            font-size: 24px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .lesson-section h2::before {
            content: '';
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 100%);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }
        .lesson-section p {
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }
        .lesson-section ul {
            line-height: 1.8;
            color: var(--text-secondary);
            margin-left: 20px;
            margin-bottom: 15px;
        }
        .visual-box {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-left: 4px solid var(--primary-color);
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            position: relative;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
        }
        .visual-box::before {
            content: 'üìä';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 32px;
            opacity: 0.3;
        }
        .visual-box h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: 700;
        }
        .money-flow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }
        .flow-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            flex: 1;
            min-width: 120px;
        }
        .flow-arrow {
            font-size: 24px;
            color: var(--primary-color);
        }
        .action-box {
            background: linear-gradient(135deg, #10b98120 0%, #d1fae540 100%);
            border-left: 4px solid #10b981;
            padding: 25px;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.1);
        }
        .action-box::before {
            content: 'üéØ';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 32px;
            opacity: 0.5;
        }
        .action-box h3 {
            color: #10b981;
            margin-bottom: 10px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .reflection-box {
            background: linear-gradient(135deg, #f59e0b20 0%, #fef3c740 100%);
            border-left: 4px solid #f59e0b;
            padding: 25px;
            border-radius: 12px;
            position: relative;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.1);
        }
        .reflection-box::before {
            content: 'üí≠';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 32px;
            opacity: 0.5;
        }
        .reflection-box h3 {
            color: #f59e0b;
            margin-bottom: 10px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .mistakes-list {
            background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #dc2626;
            position: relative;
            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.1);
        }
        .mistakes-list::before {
            content: '‚ö†Ô∏è';
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 32px;
            opacity: 0.5;
        }
        .mistakes-list h3 {
            color: #dc2626;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .btn-finish {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 30px auto;
            padding: 18px;
            background: var(--primary-color);
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            transition: background 0.2s;
            border: none;
            cursor: pointer;
        }
        .btn-finish:hover {
            background: #2563eb;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .quiz-container {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            padding: 30px;
            margin: 40px 0 30px 0;
        }
        .quiz-header {
            text-align: center;
            margin-bottom: 25px;
        }
        .quiz-header h2 {
            color: var(--primary-color);
            font-size: 28px;
            margin-bottom: 10px;
        }
        .quiz-header p {
            color: var(--text-secondary);
            font-size: 16px;
        }
        .question-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
        }
        .answer-option {
            background: #f9fafb;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .answer-option:hover {
            border-color: var(--primary-color);
            background: #eff6ff;
        }
        .answer-option.selected {
            border-color: var(--primary-color);
            background: #dbeafe;
        }
        .answer-option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }
        .answer-option.incorrect {
            border-color: #dc2626;
            background: #fee2e2;
        }
        .btn-submit-quiz {
            display: block;
            width: 100%;
            max-width: 300px;
            margin: 20px auto;
            padding: 15px;
            background: var(--primary-color);
            color: white;
            text-align: center;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-submit-quiz:hover {
            background: #2563eb;
        }
        .btn-submit-quiz:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .quiz-result {
            background: white;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            margin-top: 20px;
        }
        .quiz-result.pass {
            border: 3px solid #10b981;
        }
        .quiz-result.fail {
            border: 3px solid #dc2626;
        }
        .result-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        .result-text {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .result-score {
            font-size: 18px;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        .btn-retry {
            padding: 12px 24px;
            background: #f59e0b;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        .btn-retry:hover {
            background: #d97706;
        }
        .btn-finish:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            opacity: 0.6;
        }
        /* Multi-screen styles */
        .lesson-screen {
            display: none;
        }
        .lesson-screen.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .screen-progress {
            text-align: center;
            margin-bottom: 20px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 8px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 14px;
        }
        .screen-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e5e7eb;
        }
        .btn-nav {
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .btn-nav:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        .btn-nav:disabled {
            background: #d1d5db;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .btn-nav.btn-prev {
            background: #6b7280;
        }
        .btn-nav.btn-prev:hover {
            background: #4b5563;
        }
        .nav-spacer {
            width: 120px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo"><a href="index.html" style="color: inherit; text-decoration: none;">Finance<span class="logo-accent">U</span></a></div>
                <ul class="nav-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li id="authButtons" style="opacity: 0;">
                    </li>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Lesson Content -->
    <div class="lesson-container">
        <a href="pillar1-lessons.html" class="back-link">‚Üê Back to Pillar 1 Lessons</a>

        <!-- Header -->
        <div class="lesson-header">
            <div class="lesson-number">LESSON 1</div>
            <h1>What is Money?</h1>
        </div>

        <!-- Screen 1: Quick Intro -->
        <div class="lesson-screen active" data-screen="1">
            <div class="screen-progress">Screen 1 of 6</div>
            <div class="lesson-section">
                <h2>Quick Intro</h2>
                <p>Before you can master your finances, you need to understand what money actually is. It's more than just paper bills and coins‚Äîit's a fundamental tool that shapes our daily lives and future opportunities. In this lesson, we'll explore the true nature of money and why understanding it is your first step toward financial confidence.</p>
            </div>
            <div class="screen-navigation">
                <div class="nav-spacer"></div>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 2: Core Concept -->
        <div class="lesson-screen" data-screen="2">
            <div class="screen-progress">Screen 2 of 6</div>
            <div class="lesson-section">
                <h2>Core Concept</h2>
                <p><strong>Money is a medium of exchange, a store of value, and a unit of account.</strong></p>
                <p>Let's break that down:</p>
                <ul>
                    <li><strong>Medium of Exchange:</strong> Money allows you to trade your work or goods for other things you need without having to barter directly. Instead of trading chickens for shoes, you sell chickens for money, then use that money to buy shoes.</li>
                    <li><strong>Store of Value:</strong> Money holds its worth over time, allowing you to save today and spend tomorrow. You can earn money now and use it months or years later.</li>
                    <li><strong>Unit of Account:</strong> Money provides a common way to measure value. Everything has a price tag, making it easy to compare what things are worth.</li>
                </ul>
                <p>Money only works because we all agree it has value. A $20 bill is just paper, but society accepts it as payment because we trust it represents real value.</p>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 3: Simple Example -->
        <div class="lesson-screen" data-screen="3">
            <div class="screen-progress">Screen 3 of 6</div>
            <div class="lesson-section">
                <h2>Simple Example</h2>
                <p>Imagine you're a talented artist who creates beautiful paintings. You want to buy groceries, pay rent, and get a haircut. Without money, you'd have to:</p>
                <ul>
                    <li>Find a grocery store owner who wants a painting</li>
                    <li>Find a landlord who accepts art as rent payment</li>
                    <li>Find a hairstylist willing to trade a haircut for artwork</li>
                </ul>
                <p>This would be incredibly difficult and time-consuming! With money, you simply sell your paintings to anyone who wants them, receive cash, and use that cash to buy whatever you need from whoever is selling it. Money makes the exchange smooth and simple.</p>
            </div>

            <!-- Mini Visual -->
            <div class="visual-box">
                <h3>How Money Flows in Your Life</h3>
                <div class="money-flow">
                    <div class="flow-item">
                        <strong>You Work</strong>
                        <p style="font-size: 14px; margin-top: 8px;">Provide value through labor or skills</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-item">
                        <strong>You Earn Money</strong>
                        <p style="font-size: 14px; margin-top: 8px;">Receive payment for your work</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-item">
                        <strong>You Spend Money</strong>
                        <p style="font-size: 14px; margin-top: 8px;">Exchange it for goods and services</p>
                    </div>
                </div>
                <p style="margin-top: 20px; text-align: center; color: var(--text-secondary); font-size: 14px;">Money is the bridge between what you offer and what you need.</p>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 4: Common Mistakes -->
        <div class="lesson-screen" data-screen="4">
            <div class="screen-progress">Screen 4 of 6</div>
            <div class="lesson-section">
                <div class="mistakes-list">
                    <h3>Common Mistakes to Avoid</h3>
                    <ul style="margin-left: 20px;">
                        <li><strong>Thinking money equals happiness:</strong> Money is a tool, not a life goal. It provides security and options, but relationships, health, and purpose create fulfillment.</li>
                        <li><strong>Believing money is evil:</strong> Money is neutral. It's how you earn it and use it that matters. It can fund education, help others, or build businesses.</li>
                        <li><strong>Forgetting money's limitations:</strong> Money can't buy time, genuine relationships, or health. Use it wisely for what it can provide.</li>
                        <li><strong>Treating all money the same:</strong> $100 earned, borrowed, or gifted may feel the same, but each has different implications for your financial health.</li>
                    </ul>
                </div>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 5: Micro Action + Quick Reflection -->
        <div class="lesson-screen" data-screen="5">
            <div class="screen-progress">Screen 5 of 6</div>
            <!-- Micro Action -->
            <div class="lesson-section">
                <div class="action-box">
                    <h3>üéØ Your Micro Action</h3>
                    <p><strong>Take 2 minutes to look at a bill or coin in your wallet or phone payment app.</strong></p>
                    <p>Really observe it. Remember: this is just paper, metal, or digital numbers, but it represents hours of someone's work, the ability to buy food, or the potential to save for a goal. Think about the last time you earned money‚Äîwhat did you trade for it? Your time? Your skills? Your creativity?</p>
                    <p>Understanding this connection helps you value your money more and make better choices with it.</p>
                </div>
            </div>

            <!-- Quick Reflection -->
            <div class="lesson-section">
                <div class="reflection-box">
                    <h3>üí≠ Quick Reflection</h3>
                    <p><strong>Think about this:</strong></p>
                    <p>What does money mean to you personally? Is it security? Freedom? Stress? Opportunity? There's no right answer‚Äîyour relationship with money is shaped by your experiences, family, and culture. Understanding your feelings about money is the first step to taking control of it.</p>
                    <p style="margin-top: 15px; font-size: 14px; font-style: italic;">Take a moment to consider this before moving forward.</p>
                </div>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 6: Quiz -->
        <div class="lesson-screen" data-screen="6">
            <div class="screen-progress">Screen 6 of 6</div>
            <!-- Lesson Quiz -->
            <div class="quiz-container" id="quizContainer">
            <div class="quiz-header">
                <h2>Lesson Quiz</h2>
                <p>Answer these questions to unlock the next lesson. You need 80% (3 out of 4) to pass.</p>
            </div>
            <div id="quizQuestions"></div>
            <button class="btn-submit-quiz" id="submitQuiz" onclick="submitQuiz()">Submit Quiz</button>
            <div id="quizResult"></div>
            </div>

            <!-- Finish Button -->
            <button class="btn-finish" id="finishBtn" onclick="finishLesson()" disabled>Finish Lesson</button>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <div class="nav-spacer"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FinanceU</h4>
                    <p>Making financial literacy accessible for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="about.html">About Us</a></li>
                        <li><a href="careers.html">Careers</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="help.html">Help Center</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="terms.html">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 10px;">Disclaimer: FinanceU provides educational content only and does not offer financial, legal, or investment advice. Always consult with a qualified professional before making financial decisions.</p>
                <p>&copy; 2025 FinanceU. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script>
        // Check authentication status and update nav
                async function updateNav() {
            const authButtons = document.getElementById('authButtons');

            // Check localStorage for cached auth state and render immediately
            const cachedAuth = localStorage.getItem('authState');
            if (cachedAuth) {
                const authState = JSON.parse(cachedAuth);
                authButtons.innerHTML = authState.isLoggedIn
                    ? `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`
                    : `<a href="login.html" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }

            // Then verify with server in background
            try {
                const response = await fetch(`${API_URL}/auth/me`, { credentials: 'include' });

                if (response.ok) {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: true }));
                    authButtons.innerHTML = `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`;
                } else {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                    authButtons.innerHTML = `<a href="login.html" class="btn-primary">Login</a>`;
                }
                authButtons.style.opacity = '1';
            } catch (error) {
                console.log('Not logged in');
                localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                authButtons.innerHTML = `<a href="login.html" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }
        }
        // Logout function
        async function logout() {
            localStorage.removeItem('authState');
            localStorage.removeItem('token');
            localStorage.removeItem('userId');
            try {
                await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/index.html';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/index.html';
            }
        }

        // Quiz data with multiple versions of each question
        const quizData = [
            {
                versions: [
                    {
                        question: "What are the three main functions of money?",
                        options: [
                            "Medium of exchange, store of value, unit of account",
                            "Earning, spending, and saving",
                            "Cash, credit, and investments",
                            "Income, expenses, and profit"
                        ],
                        correct: 0
                    },
                    {
                        question: "Which of the following is NOT a primary function of money?",
                        options: [
                            "Creating happiness",
                            "Medium of exchange",
                            "Store of value",
                            "Unit of account"
                        ],
                        correct: 0
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "Why does money have value?",
                        options: [
                            "Because it's made of special paper",
                            "Because society agrees it has value",
                            "Because the government prints it",
                            "Because it's backed by gold"
                        ],
                        correct: 1
                    },
                    {
                        question: "What makes a $20 bill valuable?",
                        options: [
                            "The paper it's printed on",
                            "The ink used to print it",
                            "Collective trust and acceptance by society",
                            "The serial number on it"
                        ],
                        correct: 2
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "What problem does money solve compared to bartering?",
                        options: [
                            "It makes things more expensive",
                            "It eliminates the need to find someone who wants what you have",
                            "It makes transactions slower",
                            "It requires more paperwork"
                        ],
                        correct: 1
                    },
                    {
                        question: "How does money improve upon the barter system?",
                        options: [
                            "You don't need to trade goods directly with someone who wants them",
                            "It makes all goods cost the same",
                            "It prevents people from saving",
                            "It eliminates the need for work"
                        ],
                        correct: 0
                    }
                ]
            },
            {
                versions: [
                    {
                        question: "According to the lesson, which statement about money is true?",
                        options: [
                            "Money equals happiness",
                            "Money is evil",
                            "Money is a neutral tool",
                            "All money has the same impact on your finances"
                        ],
                        correct: 2
                    },
                    {
                        question: "What is the best way to think about money?",
                        options: [
                            "As the ultimate life goal",
                            "As something to avoid",
                            "As a tool that provides security and options",
                            "As something that only creates problems"
                        ],
                        correct: 2
                    }
                ]
            }
        ];

        let currentQuestions = [];
        let userAnswers = [];
        let quizPassed = false;

        // Initialize quiz
        function initQuiz() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                console.error('No valid userId found');
                document.getElementById('finishBtn').disabled = true;
                return;
            }

            const quizPassedStatus = localStorage.getItem(`lesson1_quiz_passed_${userId}`);

            if (quizPassedStatus === 'true') {
                quizPassed = true;
                document.getElementById('finishBtn').disabled = false;
                document.getElementById('quizContainer').style.display = 'none';
                return;
            }

            // Select random version of each question
            currentQuestions = quizData.map(q => {
                const randomVersion = q.versions[Math.floor(Math.random() * q.versions.length)];
                return randomVersion;
            });

            renderQuiz();
        }

        function renderQuiz() {
            const questionsContainer = document.getElementById('quizQuestions');
            questionsContainer.innerHTML = '';
            userAnswers = new Array(currentQuestions.length).fill(null);

            currentQuestions.forEach((q, qIndex) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.innerHTML = `
                    <div class="question-text">Question ${qIndex + 1}: ${q.question}</div>
                    ${q.options.map((option, oIndex) => `
                        <div class="answer-option" onclick="selectAnswer(${qIndex}, ${oIndex})">
                            <input type="radio" name="question${qIndex}" value="${oIndex}" style="margin-right: 10px;">
                            ${option}
                        </div>
                    `).join('')}
                `;
                questionsContainer.appendChild(questionCard);
            });

            document.getElementById('submitQuiz').disabled = false;
            document.getElementById('quizResult').innerHTML = '';
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            // Update visual selection
            const questionCard = document.querySelectorAll('.question-card')[questionIndex];
            const options = questionCard.querySelectorAll('.answer-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            // Check if all questions are answered
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting.');
                return;
            }

            // Calculate score
            let correct = 0;
            currentQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = Math.round((correct / currentQuestions.length) * 100);
            const passed = percentage >= 80;

            // Show correct/incorrect answers
            document.querySelectorAll('.question-card').forEach((card, qIndex) => {
                const options = card.querySelectorAll('.answer-option');
                options.forEach((opt, oIndex) => {
                    opt.style.pointerEvents = 'none';
                    if (oIndex === currentQuestions[qIndex].correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[qIndex] && oIndex !== currentQuestions[qIndex].correct) {
                        opt.classList.add('incorrect');
                    }
                });
            });

            // Display result
            const resultDiv = document.getElementById('quizResult');
            if (passed) {
                quizPassed = true;
                const userId = localStorage.getItem('userId');
                localStorage.setItem(`lesson1_quiz_passed_${userId}`, 'true');
                document.getElementById('finishBtn').disabled = false;

                resultDiv.innerHTML = `
                    <div class="quiz-result pass">
                        <div class="result-icon">üéâ</div>
                        <div class="result-text" style="color: #10b981;">Quiz Passed!</div>
                        <div class="result-score">You scored ${correct} out of ${currentQuestions.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary);">Great job! You can now finish the lesson and move to the next one.</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="quiz-result fail">
                        <div class="result-icon">üìö</div>
                        <div class="result-text" style="color: #dc2626;">Not quite there yet</div>
                        <div class="result-score">You scored ${correct} out of ${currentQuestions.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">You need 80% to pass. Review the lesson and try again!</p>
                        <button class="btn-retry" onclick="retryQuiz()">Retry Quiz</button>
                    </div>
                `;
            }

            document.getElementById('submitQuiz').style.display = 'none';
        }

        function retryQuiz() {
            // Re-initialize with new question versions
            currentQuestions = quizData.map(q => {
                const randomVersion = q.versions[Math.floor(Math.random() * q.versions.length)];
                return randomVersion;
            });
            renderQuiz();
            document.getElementById('submitQuiz').style.display = 'block';
        }

        function finishLesson() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                alert('Please log in to save your progress.');
                return;
            }

            if (!quizPassed) {
                alert('Please complete the quiz first!');
                return;
            }

            // Get completed lessons from localStorage
            const completed = JSON.parse(localStorage.getItem(`pillar1_completed_${userId}`) || '[]');

            // Add lesson 1 if not already completed
            if (!completed.includes(1)) {
                completed.push(1);
                localStorage.setItem(`pillar1_completed_${userId}`, JSON.stringify(completed));
            }

            // Redirect back to lessons page
            window.location.href = 'pillar1-lessons.html';
        }

        updateNav();
        initQuiz();

        // Multi-screen navigation
        let currentScreen = 1;
        const totalScreens = 6;

        function showScreen(screenNumber) {
            // Hide all screens
            document.querySelectorAll('.lesson-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // Show the requested screen
            const targetScreen = document.querySelector(`.lesson-screen[data-screen="${screenNumber}"]`);
            if (targetScreen) {
                targetScreen.classList.add('active');
                currentScreen = screenNumber;

                // Smooth scroll to top of lesson container
                const lessonContainer = document.querySelector('.lesson-container');
                const headerOffset = 80; // Height of navbar
                const elementPosition = lessonContainer.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });
            }
        }

        function nextScreen() {
            if (currentScreen < totalScreens) {
                showScreen(currentScreen + 1);
            }
        }

        function previousScreen() {
            if (currentScreen > 1) {
                showScreen(currentScreen - 1);
            }
        }

        // Initialize first screen on page load
        document.addEventListener('DOMContentLoaded', function() {
            showScreen(1);
        });
    </script>
</body>
</html>
