<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 3 - Choosing Your First Credit Card - FinanceU</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="assets/favicon-16x16.svg">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="assets/favicon-32x32.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.svg">
    <link rel="stylesheet" href="styles.css">
    <style>
        .lesson-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        .lesson-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 35px;
            background: linear-gradient(135deg, #DC2626 0%, #991B1B 100%);
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            border: 5px solid #FCA5A5;
        }
        .lesson-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .lesson-header h1 {
            font-size: 32px;
            font-weight: 900;
            color: white;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }
        .lesson-header .lesson-number {
            color: rgba(255, 255, 255, 0.95);
            font-size: 16px;
            font-weight: 800;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        .lesson-section {
            background: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: 4px solid #FCA5A5;
            position: relative;
            transition: all 0.3s ease;
        }
        .lesson-section:hover {
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.25);
            transform: translateY(-3px);
        }
        .lesson-section h2 {
            color: #DC2626;
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .lesson-section h3 {
            color: #DC2626;
            font-size: 32px;
            font-weight: 800;
            margin: 25px 0 15px 0;
        }
        .lesson-section p {
            line-height: 1.9;
            color: var(--text-secondary);
            margin-bottom: 18px;
            font-size: 18px;
        }
        .lesson-section ul {
            line-height: 1.9;
            color: var(--text-secondary);
            margin-left: 25px;
            margin-bottom: 18px;
            font-size: 18px;
        }
        .lesson-section ul li {
            margin-bottom: 12px;
            font-weight: 500;
        }
        .lesson-section strong {
            color: #DC2626;
            font-weight: 800;
        }
        .icon-large {
            font-size: 64px;
            display: inline-block;
        }
        .callout-box {
            background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%);
            border-left: 5px solid #DC2626;
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
            position: relative;
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.2);
        }
        .callout-box h3 {
            color: #DC2626;
            margin-bottom: 15px;
            font-size: 28px;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .callout-box p {
            font-size: 18px;
            line-height: 1.8;
            color: #991B1B;
            font-weight: 600;
        }
        .info-box {
            background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%);
            border-left: 5px solid #3B82F6;
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }
        .info-box h3 {
            color: #1E40AF;
            margin-bottom: 15px;
            font-size: 28px;
            font-weight: 800;
        }
        .success-box {
            background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
            border-left: 5px solid #10B981;
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }
        .success-box h3 {
            color: #047857;
            margin-bottom: 15px;
            font-size: 28px;
            font-weight: 800;
        }
        .warning-box {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border-left: 5px solid #F59E0B;
            padding: 30px;
            border-radius: 16px;
            margin: 25px 0;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.2);
        }
        .warning-box h3 {
            color: #D97706;
            margin-bottom: 15px;
            font-size: 28px;
            font-weight: 800;
        }
        .card-comparison-table {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            margin: 25px 0;
            border: 4px solid #FCA5A5;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .card-comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }
        .card-comparison-table th {
            background: linear-gradient(135deg, #DC2626 0%, #991B1B 100%);
            color: white;
            padding: 20px;
            text-align: left;
            font-weight: 800;
            font-size: 20px;
        }
        .card-comparison-table td {
            padding: 18px 20px;
            border-bottom: 2px solid #FEE2E2;
            font-size: 17px;
            font-weight: 600;
        }
        .card-comparison-table tr:last-child td {
            border-bottom: none;
        }
        .card-comparison-table tr:hover {
            background: #FEF2F2;
        }
        .btn-finish {
            display: block;
            width: 100%;
            max-width: 500px;
            margin: 40px auto;
            padding: 25px;
            background: linear-gradient(135deg, #DC2626 0%, #991B1B 100%);
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 16px;
            font-size: 24px;
            font-weight: 900;
            transition: all 0.3s;
            border: 5px solid #FCA5A5;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-finish:hover {
            background: linear-gradient(135deg, #991B1B 0%, #7F1D1D 100%);
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(220, 38, 38, 0.4);
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #DC2626;
            text-decoration: none;
            font-weight: 800;
            font-size: 18px;
            transition: all 0.2s;
        }
        .back-link:hover {
            transform: translateX(-5px);
        }
        .quiz-container {
            background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%);
            border: 5px solid #DC2626;
            border-radius: 16px;
            padding: 35px;
            margin: 40px 0 30px 0;
        }
        .quiz-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .quiz-header h2 {
            color: #DC2626;
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        .quiz-header p {
            color: #991B1B;
            font-size: 18px;
            font-weight: 700;
        }
        .question-card {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 3px solid #FCA5A5;
        }
        .question-text {
            font-size: 22px;
            font-weight: 800;
            color: #DC2626;
            margin-bottom: 20px;
        }
        .answer-option {
            background: #FEF2F2;
            padding: 18px;
            border: 3px solid #FCA5A5;
            border-radius: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 17px;
            font-weight: 600;
        }
        .answer-option:hover {
            border-color: #DC2626;
            background: #FEE2E2;
            transform: translateX(8px);
        }
        .answer-option.selected {
            border-color: #DC2626;
            background: #FECACA;
        }
        .answer-option.correct {
            border-color: #10B981;
            background: #D1FAE5;
        }
        .answer-option.incorrect {
            border-color: #EF4444;
            background: #FEE2E2;
        }
        .btn-submit-quiz {
            display: block;
            width: 100%;
            max-width: 350px;
            margin: 25px auto;
            padding: 20px;
            background: #DC2626;
            color: white;
            text-align: center;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 800;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-submit-quiz:hover {
            background: #991B1B;
            transform: scale(1.05);
        }
        .btn-submit-quiz:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
        }
        .quiz-result {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin-top: 25px;
        }
        .quiz-result.pass {
            border: 4px solid #10B981;
        }
        .quiz-result.fail {
            border: 4px solid #DC2626;
        }
        .result-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }
        .result-text {
            font-size: 32px;
            font-weight: 900;
            margin-bottom: 15px;
        }
        .result-score {
            font-size: 20px;
            color: var(--text-secondary);
            margin-bottom: 25px;
            font-weight: 700;
        }
        .btn-retry {
            padding: 15px 30px;
            background: #F59E0B;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-retry:hover {
            background: #D97706;
            transform: scale(1.05);
        }
        .btn-finish:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
            opacity: 0.6;
        }
        .screen-progress {
            text-align: center;
            margin-bottom: 25px;
            padding: 15px 25px;
            background: linear-gradient(135deg, #FEE2E2 0%, #FECACA 100%);
            border-radius: 12px;
            font-weight: 800;
            color: #DC2626;
            font-size: 18px;
            border: 3px solid #DC2626;
        }
        .lesson-screen {
            display: none;
        }
        .lesson-screen.active {
            display: block;
            animation: fadeIn 0.4s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .screen-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 3px solid #FCA5A5;
        }
        .btn-nav {
            padding: 15px 30px;
            background: #DC2626;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .btn-nav:hover {
            background: #991B1B;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(220, 38, 38, 0.3);
        }
        .btn-nav:disabled {
            background: #D1D5DB;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .btn-nav.btn-prev {
            background: #6B7280;
        }
        .btn-nav.btn-prev:hover {
            background: #4B5563;
        }
        .nav-spacer {
            width: 130px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo"><a href="/" style="color: inherit; text-decoration: none;">Finance<span class="logo-accent">U</span></a></div>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="dashboard">Dashboard</a></li>
                    <li id="authButtons" style="opacity: 0;">
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Lesson Content -->
    <div class="lesson-container">
        <a href="/pillar3-lessons" class="back-link">‚Üê Back to Pillar 3 Lessons</a>

        <!-- Header -->
        <div class="lesson-header">
            <div class="lesson-number">PILLAR 3: CREDIT FUNDAMENTALS</div>
            <h1>Choosing Your First Credit Card</h1>
        </div>

        <!-- Screen 1: Types of Cards -->
        <div class="lesson-screen active" data-screen="1">
            <div class="screen-progress">Screen 1 of 5</div>
            <div class="lesson-section">
                <h2><span class="icon-large">üí≥</span> Types of Credit Cards</h2>
                <p>Not all credit cards are created equal. Here are the main types perfect for beginners:</p>

                <div class="info-box">
                    <h3>üí∞ Cash Back Cards</h3>
                    <p><strong>What you get:</strong> 1-5% cash back on purchases</p>
                    <p><strong>Best for:</strong> Everyday spending, simple rewards</p>
                    <p><strong>Example:</strong> Spend $100 on groceries, get $2-5 back</p>
                </div>

                <div class="success-box">
                    <h3>üéÅ Rewards Cards</h3>
                    <p><strong>What you get:</strong> Points or miles for travel, merchandise</p>
                    <p><strong>Best for:</strong> People who travel or want flexibility</p>
                    <p><strong>Example:</strong> Earn points toward free flights or hotel stays</p>
                </div>

                <div class="warning-box">
                    <h3>üéì Student Cards</h3>
                    <p><strong>What you get:</strong> Easier approval, lower credit limits, basic rewards</p>
                    <p><strong>Best for:</strong> College students with no credit history</p>
                    <p><strong>Example:</strong> Build credit while earning small rewards on everyday purchases</p>
                </div>
            </div>
            <div class="screen-navigation">
                <div class="nav-spacer"></div>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 2: Understanding APR & Fees -->
        <div class="lesson-screen" data-screen="2">
            <div class="screen-progress">Screen 2 of 5</div>
            <div class="lesson-section">
                <h2><span class="icon-large">üìä</span> Key Terms You Must Know</h2>

                <h3>APR (Annual Percentage Rate)</h3>
                <p>The <strong>yearly interest rate</strong> you pay if you carry a balance.</p>

                <div class="callout-box">
                    <h3>üí∏ Real Example</h3>
                    <p>$1,000 balance at 20% APR = $200/year in interest</p>
                    <p>That's like paying $1,200 for something that cost $1,000!</p>
                </div>

                <h3>Grace Period</h3>
                <p>The <strong>21-25 days</strong> you have to pay your full balance without paying interest.</p>
                <p><strong>Key point:</strong> Pay in full before this deadline = $0 interest!</p>

                <h3>Annual Fees</h3>
                <p>Some cards charge a <strong>yearly fee</strong> just for having the card.</p>
                <ul>
                    <li><strong>$0 annual fee:</strong> Perfect for beginners</li>
                    <li><strong>$50-95 fee:</strong> Only worth it if rewards exceed the fee</li>
                    <li><strong>$450+ fee:</strong> Premium cards - avoid as a beginner</li>
                </ul>

                <h3>Foreign Transaction Fees</h3>
                <p><strong>2-3% extra</strong> charged when you use your card abroad or for international purchases.</p>
                <p><strong>Pro tip:</strong> Many student cards have NO foreign transaction fees!</p>

                <h3>Sign-up Bonuses</h3>
                <p>Free money or rewards for spending a certain amount in the first few months.</p>
                <p><strong>Example:</strong> "Spend $500 in 3 months, get $150 cash back"</p>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 3: Card Comparison Table -->
        <div class="lesson-screen" data-screen="3">
            <div class="screen-progress">Screen 3 of 5</div>
            <div class="lesson-section">
                <h2><span class="icon-large">üéØ</span> Best Starter Cards Compared</h2>
                <p>Here's how popular student cards stack up:</p>

                <div class="card-comparison-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Card</th>
                                <th>Cash Back / Rewards</th>
                                <th>Annual Fee</th>
                                <th>Best For</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Discover Student</strong></td>
                                <td>5% rotating categories<br>1% everything else</td>
                                <td>$0</td>
                                <td>Maximizing rewards on rotating categories</td>
                            </tr>
                            <tr>
                                <td><strong>Capital One SavorOne Student</strong></td>
                                <td>3% dining & entertainment<br>1% everything else</td>
                                <td>$0</td>
                                <td>Students who eat out frequently</td>
                            </tr>
                            <tr>
                                <td><strong>Chase Freedom Student</strong></td>
                                <td>1% on everything<br>Bonus categories vary</td>
                                <td>$0</td>
                                <td>Simple, straightforward rewards</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="callout-box">
                    <h3>üßÆ How to Calculate Which Card Wins</h3>
                    <p><strong>Step 1:</strong> Track where you spend the most money</p>
                    <p><strong>Step 2:</strong> Match your spending to the card's bonus categories</p>
                    <p><strong>Step 3:</strong> Calculate annual rewards minus any fees</p>
                    <p><strong>Example:</strong> If you spend $300/month dining out, the SavorOne gives you $108/year in rewards ($300 √ó 12 √ó 3% = $108)</p>
                </div>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 4: Action Items -->
        <div class="lesson-screen" data-screen="4">
            <div class="screen-progress">Screen 4 of 5</div>
            <div class="lesson-section">
                <h2><span class="icon-large">‚úÖ</span> Your Action Plan</h2>

                <div class="success-box">
                    <h3>üìù What to Do Next</h3>
                    <p><strong>1. Compare 3-5 starter cards</strong> - Use the comparison table above as a starting point</p>
                    <p><strong>2. Calculate which rewards match your spending</strong> - Be honest about where your money actually goes</p>
                    <p><strong>3. Check for pre-approval</strong> - Many banks let you check without hurting your credit score</p>
                    <p><strong>4. Read the fine print</strong> - Look for hidden fees or requirements</p>
                    <p><strong>5. Apply for ONE card</strong> - Multiple applications can hurt your credit score</p>
                </div>

                <div class="warning-box">
                    <h3>‚ö†Ô∏è Before You Apply</h3>
                    <p><strong>Have you checked your credit score?</strong> Most student cards require fair credit (580+)</p>
                    <p><strong>Do you have income?</strong> Even part-time work counts</p>
                    <p><strong>Can you pay the full balance monthly?</strong> If not, wait until you can</p>
                </div>

                <div class="info-box">
                    <h3>üí° Pro Tips</h3>
                    <p><strong>Avoid store credit cards</strong> - They often have APRs of 25-30%</p>
                    <p><strong>Don't chase sign-up bonuses</strong> - Only spend what you normally would</p>
                    <p><strong>Start with one card</strong> - Master responsible use before getting more</p>
                </div>
            </div>
            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <button class="btn-nav" onclick="nextScreen()">Next <span>‚Üí</span></button>
            </div>
        </div>

        <!-- Screen 5: Quiz -->
        <div class="lesson-screen" data-screen="5">
            <div class="screen-progress">Screen 5 of 5</div>
            <!-- Lesson Quiz -->
            <div class="quiz-container" id="quizContainer" style="display: none;">
                <div class="quiz-header">
                    <h2>Mini-Quiz</h2>
                    <p>Test your knowledge - answer all 3 questions correctly!</p>
                </div>
                <div id="quizQuestions"></div>
                <button class="btn-submit-quiz" id="submitQuiz" onclick="submitQuiz()">Submit Quiz</button>
                <div id="quizResult"></div>
            </div>

            <!-- Finish Button -->
            <button class="btn-finish" id="finishBtn" onclick="finishLesson()" disabled>Complete Lesson</button>

            <div class="screen-navigation">
                <button class="btn-nav btn-prev" onclick="previousScreen()"><span>‚Üê</span> Previous</button>
                <div class="nav-spacer"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>FinanceU</h4>
                    <p>Making financial literacy accessible for everyone.</p>
                </div>
                <div class="footer-section">
                    <h4>Company</h4>
                    <ul>
                        <li><a href="/about">About Us</a></li>
                        <li><a href="/careers">Careers</a></li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="/help">Help Center</a></li>
                        <li><a href="/privacy">Privacy Policy</a></li>
                        <li><a href="/terms">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p style="font-size: 0.85rem; opacity: 0.8; margin-bottom: 10px;">Disclaimer: FinanceU provides educational content only and does not offer financial, legal, or investment advice. Always consult with a qualified professional before making financial decisions.</p>
                <p>&copy; 2025 FinanceU. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="config.js"></script>
    <script src="lesson-completion.js"></script>
    <script src="animations.js"></script>
    <script>
        // Check authentication status and update nav
        async function updateNav() {
            const authButtons = document.getElementById('authButtons');

            // Check localStorage for cached auth state and render immediately
            const cachedAuth = localStorage.getItem('authState');
            if (cachedAuth) {
                const authState = JSON.parse(cachedAuth);
                authButtons.innerHTML = authState.isLoggedIn
                    ? `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`
                    : `<a href="login" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }

            // Then verify with server in background
            try {
                const response = await fetch(`${API_URL}/auth/me`, { credentials: 'include' });

                if (response.ok) {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: true }));
                    authButtons.innerHTML = `<a href="#" onclick="logout(); return false;" class="btn-primary">Logout</a>`;
                } else {
                    localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                    authButtons.innerHTML = `<a href="login" class="btn-primary">Login</a>`;
                }
                authButtons.style.opacity = '1';
            } catch (error) {
                console.log('Not logged in');
                localStorage.setItem('authState', JSON.stringify({ isLoggedIn: false }));
                authButtons.innerHTML = `<a href="login" class="btn-primary">Login</a>`;
                authButtons.style.opacity = '1';
            }
        }

        // Logout function
        async function logout() {
            localStorage.removeItem('authState');
            localStorage.removeItem('token');
            localStorage.removeItem('userId');
            try {
                await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/index.html';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/index.html';
            }
        }

        // Quiz data
        const quizData = [
            {
                question: "What is APR?",
                options: [
                    "Annual Payment Required",
                    "Annual Percentage Rate - the yearly interest you pay",
                    "Automatic Payment Reminder",
                    "Average Purchase Rate"
                ],
                correct: 1
            },
            {
                question: "What is a grace period?",
                options: [
                    "Extra time before your card expires",
                    "Time to pay your balance without interest (21-25 days)",
                    "Period when you can't use your card",
                    "Time to change your mind on a purchase"
                ],
                correct: 1
            },
            {
                question: "Which type of credit card typically has the highest APR?",
                options: [
                    "Student cards",
                    "Cash back cards",
                    "Store credit cards",
                    "Travel rewards cards"
                ],
                correct: 2
            }
        ];

        let userAnswers = [];
        let quizPassed = false;

        // Initialize quiz
        function initQuiz() {
            const userId = localStorage.getItem('userId');

            // Validate userId exists
            if (!userId || userId === 'null' || userId === 'undefined') {
                console.error('No valid userId found');
                document.getElementById('finishBtn').disabled = true;
                return;
            }

            const quizPassedStatus = localStorage.getItem(`pillar3_lesson3_quiz_passed_${userId}`);

            if (quizPassedStatus === 'true') {
                quizPassed = true;
                document.getElementById('finishBtn').disabled = false;
                document.getElementById('quizContainer').style.display = 'none';
                return;
            }

            renderQuiz();
        }

        function renderQuiz() {
            const questionsContainer = document.getElementById('quizQuestions');
            questionsContainer.innerHTML = '';
            userAnswers = new Array(quizData.length).fill(null);

            quizData.forEach((q, qIndex) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.innerHTML = `
                    <div class="question-text">Question ${qIndex + 1}: ${q.question}</div>
                    ${q.options.map((option, oIndex) => `
                        <div class="answer-option" onclick="selectAnswer(${qIndex}, ${oIndex})">
                            <input type="radio" name="question${qIndex}" value="${oIndex}" style="margin-right: 10px;">
                            ${option}
                        </div>
                    `).join('')}
                `;
                questionsContainer.appendChild(questionCard);
            });

            document.getElementById('submitQuiz').disabled = false;
            document.getElementById('quizResult').innerHTML = '';
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            // Update visual selection
            const questionCard = document.querySelectorAll('.question-card')[questionIndex];
            const options = questionCard.querySelectorAll('.answer-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            // Check if all questions are answered
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting.');
                return;
            }

            // Calculate score
            let correct = 0;
            quizData.forEach((q, index) => {
                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const percentage = Math.round((correct / quizData.length) * 100);
            const passed = correct === quizData.length;

            // Show correct/incorrect answers
            document.querySelectorAll('.question-card').forEach((card, qIndex) => {
                const options = card.querySelectorAll('.answer-option');
                options.forEach((opt, oIndex) => {
                    opt.style.pointerEvents = 'none';
                    if (oIndex === quizData[qIndex].correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[qIndex] && oIndex !== quizData[qIndex].correct) {
                        opt.classList.add('incorrect');
                    }
                });
            });

            // Display result
            const resultDiv = document.getElementById('quizResult');
            if (passed) {
                quizPassed = true;
                const userId = localStorage.getItem('userId');
                localStorage.setItem(`pillar3_lesson3_quiz_passed_${userId}`, 'true');
                document.getElementById('finishBtn').disabled = false;

                resultDiv.innerHTML = `
                    <div class="quiz-result pass">
                        <div class="result-icon">üéâ</div>
                        <div class="result-text" style="color: #10b981;">Perfect Score!</div>
                        <div class="result-score">You scored ${correct} out of ${quizData.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary);">Excellent! You're ready to choose your first credit card wisely.</p>
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `
                    <div class="quiz-result fail">
                        <div class="result-icon">üìö</div>
                        <div class="result-text" style="color: #dc2626;">Not Quite There</div>
                        <div class="result-score">You scored ${correct} out of ${quizData.length} (${percentage}%)</div>
                        <p style="color: var(--text-secondary); margin-bottom: 15px;">You need 100% to pass. Review the lesson and try again!</p>
                        <button class="btn-retry" onclick="retryQuiz()">Retry Quiz</button>
                    </div>
                `;
            }

            document.getElementById('submitQuiz').style.display = 'none';
        }

        function retryQuiz() {
            renderQuiz();
            document.getElementById('submitQuiz').style.display = 'block';
        }

        async function finishLesson() {
            if (!quizPassed) {
                alert('Please complete the quiz first!');
                return;
            }

            // Use shared completion function
            const success = await completeLesson('pillar3_lesson3', 3, 3);

            if (success) {
                // Redirect back to lessons page
                window.location.href = 'pillar3-lessons.html';
            }
        }        // Interactive element functions
        function toggleReveal(element) {
            const content = element.querySelector('.reveal-content');
            const heading = element.querySelector('h3');
            if (content.classList.contains('show')) {
                content.classList.remove('show');
                heading.innerHTML = heading.innerHTML.replace('‚ñ≤', '‚ñº');
            } else {
                content.classList.add('show');
                heading.innerHTML = heading.innerHTML.replace('‚ñº', '‚ñ≤');
            }
        }

        function checkMini(element, isCorrect) {
            const parent = element.parentElement;
            const options = parent.querySelectorAll('.mini-option');
            options.forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
                opt.style.pointerEvents = 'none';
            });

            if (isCorrect) {
                element.classList.add('correct');
                element.innerHTML += ' ‚úì Correct!';
            } else {
                element.classList.add('incorrect');
                element.innerHTML += ' ‚úó';
                options.forEach(opt => {
                    if (opt.onclick && opt.onclick.toString().includes('true')) {
                        opt.classList.add('correct');
                        opt.innerHTML += ' ‚Üê Correct Answer';
                    }
                });
            }
        }

        function calculateUtilization() {
            const balance = parseFloat(document.getElementById('balance').value) || 0;
            const limit = parseFloat(document.getElementById('limit').value) || 0;
            const resultDiv = document.getElementById('utilResult');

            if (limit === 0) {
                resultDiv.textContent = 'Enter your credit limit';
                resultDiv.style.background = 'white';
                return;
            }

            const utilization = ((balance / limit) * 100).toFixed(1);
            let message = `Your utilization: ${utilization}%`;
            let feedback = '';
            let color = '';

            if (utilization <= 10) {
                feedback = 'üåü Excellent! This helps your score.';
                color = '#D1FAE5';
            } else if (utilization <= 30) {
                feedback = '‚úÖ Good! You\'re in the sweet spot.';
                color = '#FEF3C7';
            } else if (utilization <= 50) {
                feedback = '‚ö†Ô∏è Fair - Try to pay down to under 30%.';
                color = '#FED7AA';
            } else {
                feedback = 'üö® High! This is hurting your score. Pay down ASAP.';
                color = '#FEE2E2';
            }

            resultDiv.innerHTML = `<strong>${message}</strong><br><span style="font-size: 15px;">${feedback}</span>`;
            resultDiv.style.background = color;
        }

        // Multi-screen navigation
        let currentSection = 0;
        const sections = document.querySelectorAll('.lesson-section');
        const totalSections = sections.length;
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const lessonNav = document.getElementById('lessonNav');
        const quizContainer = document.getElementById('quizContainer');

        function showSection(index) {
            sections.forEach(section => section.classList.remove('active'));
            if (index >= 0 && index < totalSections) {
                sections[index].classList.add('active');
                currentSection = index;
                prevBtn.disabled = currentSection === 0;
                const progress = ((currentSection + 1) / totalSections) * 100;
                progressFill.style.width = progress + '%';
                progressText.textContent = `Section ${currentSection + 1} of ${totalSections}`;
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function nextSection() {
            if (currentSection < totalSections - 1) {
                showSection(currentSection + 1);
            } else {
                lessonNav.style.display = 'none';
                quizContainer.style.display = 'block';
                window.scrollTo({ top: quizContainer.offsetTop - 100, behavior: 'smooth' });
            }
        }

        function previousSection() {
            if (currentSection > 0) {
                showSection(currentSection - 1);
            }
        }

        showSection(0);



        updateNav();
        initQuiz();        // Interactive element functions
        function toggleReveal(element) {
            const content = element.querySelector('.reveal-content');
            const heading = element.querySelector('h3');
            if (content.classList.contains('show')) {
                content.classList.remove('show');
                heading.innerHTML = heading.innerHTML.replace('‚ñ≤', '‚ñº');
            } else {
                content.classList.add('show');
                heading.innerHTML = heading.innerHTML.replace('‚ñº', '‚ñ≤');
            }
        }

        function checkMini(element, isCorrect) {
            const parent = element.parentElement;
            const options = parent.querySelectorAll('.mini-option');
            options.forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
                opt.style.pointerEvents = 'none';
            });

            if (isCorrect) {
                element.classList.add('correct');
                element.innerHTML += ' ‚úì Correct!';
            } else {
                element.classList.add('incorrect');
                element.innerHTML += ' ‚úó';
                options.forEach(opt => {
                    if (opt.onclick && opt.onclick.toString().includes('true')) {
                        opt.classList.add('correct');
                        opt.innerHTML += ' ‚Üê Correct Answer';
                    }
                });
            }
        }

        function calculateUtilization() {
            const balance = parseFloat(document.getElementById('balance').value) || 0;
            const limit = parseFloat(document.getElementById('limit').value) || 0;
            const resultDiv = document.getElementById('utilResult');

            if (limit === 0) {
                resultDiv.textContent = 'Enter your credit limit';
                resultDiv.style.background = 'white';
                return;
            }

            const utilization = ((balance / limit) * 100).toFixed(1);
            let message = `Your utilization: ${utilization}%`;
            let feedback = '';
            let color = '';

            if (utilization <= 10) {
                feedback = 'üåü Excellent! This helps your score.';
                color = '#D1FAE5';
            } else if (utilization <= 30) {
                feedback = '‚úÖ Good! You\'re in the sweet spot.';
                color = '#FEF3C7';
            } else if (utilization <= 50) {
                feedback = '‚ö†Ô∏è Fair - Try to pay down to under 30%.';
                color = '#FED7AA';
            } else {
                feedback = 'üö® High! This is hurting your score. Pay down ASAP.';
                color = '#FEE2E2';
            }

            resultDiv.innerHTML = `<strong>${message}</strong><br><span style="font-size: 15px;">${feedback}</span>`;
            resultDiv.style.background = color;
        }



        // Multi-screen navigation
        let currentScreen = 1;
        const totalScreens = 5;

        function showScreen(screenNumber) {
            // Hide all screens
            document.querySelectorAll('.lesson-screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // Show the requested screen
            const targetScreen = document.querySelector(`.lesson-screen[data-screen="${screenNumber}"]`);
            if (targetScreen) {
                targetScreen.classList.add('active');
                currentScreen = screenNumber;

                // Smooth scroll to top of lesson container
                const lessonContainer = document.querySelector('.lesson-container');
                const headerOffset = 80;
                const elementPosition = lessonContainer.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

                window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth'
                });
            }
        }

        function nextScreen() {
            if (currentScreen < totalScreens) {
                showScreen(currentScreen + 1);
            }
        }

        function previousScreen() {
            if (currentScreen > 1) {
                showScreen(currentScreen - 1);
            }
        }

        // Initialize first screen on page load
        document.addEventListener('DOMContentLoaded', function() {
            showScreen(1);
        });
    </script>
</body>
</html>
