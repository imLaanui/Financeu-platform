<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 1 - Types of Banks - FinanceU</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: #0f0f0f;
            overflow-x: hidden;
        }

        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, #e5e7eb 0%, #9ca3af 50%, #e5e7eb 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 5s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Navigation */
        .nav-blur {
            backdrop-filter: blur(12px);
            background: rgba(15, 15, 15, 0.9);
            border-bottom: 1px solid rgba(156, 163, 175, 0.15);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        /* Progress bar */
        .progress-container {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(31, 41, 55, 0.8);
            z-index: 40;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #3b82f6);
            background-size: 200% 100%;
            transition: width 0.5s ease;
            animation: shimmer 2s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 0%; }
            50% { background-position: 100% 0%; }
        }

        /* Floating particles */
        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.2;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(180deg); }
        }

        /* 3D Button Effect */
        .btn-3d {
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .btn-3d:hover {
            transform: translateY(-4px) translateZ(10px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4), 0 16px 32px rgba(0, 0, 0, 0.3), 0 0 40px rgba(209, 213, 219, 0.2);
        }

        /* Flip card */
        .flip-card {
            perspective: 1000px;
            height: 350px;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 24px;
            padding: 32px;
            cursor: pointer;
        }

        .flip-card-front {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(59, 130, 246, 0.3);
        }

        .flip-card-back {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(139, 92, 246, 0.3);
            transform: rotateY(180deg);
        }

        /* Comparison card */
        .comparison-card {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(75, 85, 99, 0.4);
            transition: all 0.4s ease;
        }

        .comparison-card:hover {
            transform: translateY(-8px);
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.9), 0 0 40px rgba(59, 130, 246, 0.2);
        }

        /* Scenario card */
        .scenario-card {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(16, 185, 129, 0.3);
            transition: all 0.4s ease;
            cursor: pointer;
        }

        .scenario-card:hover {
            border-color: rgba(16, 185, 129, 0.6);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.9), 0 0 40px rgba(16, 185, 129, 0.2);
        }

        .scenario-card.selected {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(17, 24, 39, 0.95) 100%);
            border-color: rgba(16, 185, 129, 0.8);
        }

        /* Quiz card */
        .quiz-option {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.8) 0%, rgba(17, 24, 39, 0.9) 100%);
            border: 2px solid rgba(75, 85, 99, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .quiz-option:hover {
            border-color: rgba(59, 130, 246, 0.6);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(17, 24, 39, 0.9) 100%);
        }

        .quiz-option.selected {
            border-color: rgba(59, 130, 246, 0.8);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(17, 24, 39, 0.9) 100%);
        }

        .quiz-option.correct {
            border-color: rgba(16, 185, 129, 0.8);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(17, 24, 39, 0.9) 100%);
        }

        .quiz-option.incorrect {
            border-color: rgba(239, 68, 68, 0.8);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(17, 24, 39, 0.9) 100%);
        }

        /* Glow effects */
        .glow-blue {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4), 0 0 40px rgba(59, 130, 246, 0.2);
        }

        .glow-green {
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.4), 0 0 40px rgba(16, 185, 129, 0.2);
        }

        .glow-purple {
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.4), 0 0 40px rgba(139, 92, 246, 0.2);
        }

        /* Fade in animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.6s ease-out;
        }

        /* Pulse animation */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse-animation {
            animation: pulse 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="min-h-screen relative" style="color: #d1d5db;">
    <!-- Floating Particles -->
    <div id="particles-container" style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1;"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 nav-blur">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="/" class="flex items-center space-x-2">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-gray-200 to-gray-400 glow-blue flex items-center justify-center font-bold text-xl" style="color: #1f2937;">
                        F
                    </div>
                    <span class="text-2xl font-bold gradient-text">FinanceU</span>
                </a>

                <div class="hidden md:flex items-center space-x-6">
                    <a href="/" class="text-gray-400 hover:text-gray-200 transition-colors font-medium">Home</a>
                    <a href="/dashboard" class="text-gray-400 hover:text-gray-200 transition-colors font-medium">Dashboard</a>
                </div>

                <div class="flex items-center space-x-4" id="authButtons">
                    <button onclick="logout()" class="btn-3d px-6 py-2.5 bg-gradient-to-r from-gray-200 to-gray-300 hover:from-gray-300 hover:to-gray-200 rounded-lg font-semibold glow-blue transition-all" style="color: #1f2937;">
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Progress Bar -->
    <div class="progress-container">
        <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
    </div>

    <!-- Main Content -->
    <section class="min-h-screen pt-32 pb-20 relative z-10">
        <div class="container mx-auto px-6 max-w-6xl">
            <!-- Back Button -->
            <a href="/path1-lessons" class="inline-flex items-center text-gray-400 hover:text-gray-200 transition-colors mb-8 font-medium">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                Back to Path 1 Lessons
            </a>

            <!-- Lesson Header -->
            <div class="text-center mb-16 fade-in">
                <div class="inline-block px-4 py-2 rounded-full bg-blue-500/20 border border-blue-500/40 text-blue-400 font-bold text-sm mb-4">
                    LESSON 1
                </div>
                <h1 class="text-5xl md:text-6xl font-black mb-4 text-gray-200">
                    Types of <span class="gradient-text">Banks</span>
                </h1>
                <p class="text-xl text-gray-400 max-w-2xl mx-auto">
                    Discover the difference between online and traditional banks through interactive exploration
                </p>
            </div>

            <!-- Section 1: Intro Cards -->
            <div id="section1" class="mb-24 fade-in">
                <h2 class="text-3xl font-bold text-gray-200 mb-8 text-center">Let's Get Started</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Situation Card -->
                    <div class="comparison-card rounded-3xl p-8 text-center">
                        <div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-blue-500/20 border-2 border-blue-500/40 flex items-center justify-center">
                            <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-200 mb-3">The Situation</h3>
                        <p class="text-gray-400">You need a bank account, but you're not sure which type is right for you</p>
                    </div>

                    <!-- Why It Matters Card -->
                    <div class="comparison-card rounded-3xl p-8 text-center pulse-animation">
                        <div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-yellow-500/20 border-2 border-yellow-500/40 flex items-center justify-center">
                            <svg class="w-8 h-8 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-200 mb-3">Why It Matters</h3>
                        <p class="text-gray-400">Picking the right bank makes managing your money way easier</p>
                    </div>

                    <!-- What You'll Learn Card -->
                    <div class="comparison-card rounded-3xl p-8 text-center">
                        <div class="w-16 h-16 mx-auto mb-6 rounded-2xl bg-green-500/20 border-2 border-green-500/40 flex items-center justify-center">
                            <svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-gray-200 mb-3">What You'll Learn</h3>
                        <p class="text-gray-400">The difference between online and traditional banks, and how to actually use them</p>
                    </div>
                </div>

                <div class="text-center mt-12">
                    <button onclick="nextSection()" class="btn-3d px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-xl font-bold text-white text-lg">
                        Continue Learning â†’
                    </button>
                </div>
            </div>

            <!-- Section 2: Interactive Flip Cards -->
            <div id="section2" class="mb-24 hidden">
                <h2 class="text-3xl font-bold text-gray-200 mb-4 text-center">Explore Bank Types</h2>
                <p class="text-center text-gray-400 mb-12">Click each card to flip and learn more</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                    <!-- Online Bank Flip Card -->
                    <div class="flip-card" onclick="toggleFlip(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="flex flex-col items-center justify-center h-full">
                                    <div class="w-20 h-20 rounded-2xl bg-blue-500/20 border-2 border-blue-500/40 flex items-center justify-center mb-6">
                                        <svg class="w-10 h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                                        </svg>
                                    </div>
                                    <h3 class="text-3xl font-bold text-gray-200 mb-4">Online Banks</h3>
                                    <p class="text-gray-400 text-center mb-6">Everything happens on your phone or computer</p>
                                    <span class="text-blue-400 text-sm font-semibold">Click to flip â†’</span>
                                </div>
                            </div>
                            <div class="flip-card-back overflow-y-auto">
                                <h3 class="text-2xl font-bold text-purple-400 mb-4">The Good Stuff</h3>
                                <ul class="text-gray-300 text-sm space-y-2 mb-4">
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Better interest rates:</strong> No fancy buildings means more money for you</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Lower fees:</strong> Many have zero monthly fees</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Super convenient:</strong> Bank anytime, anywhere</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Fast setup:</strong> Open account in 10 minutes from your couch</span>
                                    </li>
                                </ul>
                                <h3 class="text-xl font-bold text-red-400 mb-2 mt-4">The Downsides</h3>
                                <ul class="text-gray-300 text-sm space-y-2">
                                    <li class="flex items-start gap-2">
                                        <span class="text-red-400 mt-1">âœ—</span>
                                        <span>No physical location for face-to-face help</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-red-400 mt-1">âœ—</span>
                                        <span>Cash deposits are tricky</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Traditional Bank Flip Card -->
                    <div class="flip-card" onclick="toggleFlip(this)">
                        <div class="flip-card-inner">
                            <div class="flip-card-front">
                                <div class="flex flex-col items-center justify-center h-full">
                                    <div class="w-20 h-20 rounded-2xl bg-green-500/20 border-2 border-green-500/40 flex items-center justify-center mb-6">
                                        <svg class="w-10 h-10 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                        </svg>
                                    </div>
                                    <h3 class="text-3xl font-bold text-gray-200 mb-4">Traditional Banks</h3>
                                    <p class="text-gray-400 text-center mb-6">Physical buildings you can walk into</p>
                                    <span class="text-green-400 text-sm font-semibold">Click to flip â†’</span>
                                </div>
                            </div>
                            <div class="flip-card-back overflow-y-auto">
                                <h3 class="text-2xl font-bold text-purple-400 mb-4">The Good Stuff</h3>
                                <ul class="text-gray-300 text-sm space-y-2 mb-4">
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Face-to-face help:</strong> Talk to a real person in branch</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Easy cash deposits:</strong> Just walk in and hand it over</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>ATMs everywhere:</strong> More physical locations</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-green-400 mt-1">âœ“</span>
                                        <span><strong>Familiar and trusted:</strong> Been around for years</span>
                                    </li>
                                </ul>
                                <h3 class="text-xl font-bold text-red-400 mb-2 mt-4">The Downsides</h3>
                                <ul class="text-gray-300 text-sm space-y-2">
                                    <li class="flex items-start gap-2">
                                        <span class="text-red-400 mt-1">âœ—</span>
                                        <span>Higher fees for accounts and services</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-red-400 mt-1">âœ—</span>
                                        <span>Lower interest rates on savings</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <span class="text-red-400 mt-1">âœ—</span>
                                        <span>Limited to business hours</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="text-center">
                    <button onclick="nextSection()" class="btn-3d px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-xl font-bold text-white text-lg">
                        Continue â†’
                    </button>
                </div>
            </div>

            <!-- Section 3: Scenario Selection -->
            <div id="section3" class="mb-24 hidden">
                <h2 class="text-3xl font-bold text-gray-200 mb-4 text-center">Which Bank Type Fits You?</h2>
                <p class="text-center text-gray-400 mb-12">Click a scenario to see the best bank recommendation</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
                    <div class="scenario-card rounded-3xl p-8" onclick="selectScenario('online', this)">
                        <h3 class="text-xl font-bold text-gray-200 mb-4">Scenario A: Tech-Savvy Sarah</h3>
                        <p class="text-gray-400 mb-4">Sarah is comfortable with apps, rarely deals with cash, and wants to save money on fees. She values convenience and likes managing things on her own time.</p>
                        <div class="scenario-result hidden mt-4 p-4 rounded-xl bg-green-500/20 border border-green-500/40">
                            <p class="text-green-400 font-bold mb-2">âœ“ Best Match: Online Bank</p>
                            <p class="text-gray-300 text-sm">Sarah would benefit from lower fees, better interest rates, and 24/7 access to her accounts.</p>
                        </div>
                    </div>

                    <div class="scenario-card rounded-3xl p-8" onclick="selectScenario('traditional', this)">
                        <h3 class="text-xl font-bold text-gray-200 mb-4">Scenario B: Traditional Tom</h3>
                        <p class="text-gray-400 mb-4">Tom works a cash-heavy job, prefers talking to someone in person when he has questions, and likes knowing there's a physical location nearby.</p>
                        <div class="scenario-result hidden mt-4 p-4 rounded-xl bg-green-500/20 border border-green-500/40">
                            <p class="text-green-400 font-bold mb-2">âœ“ Best Match: Traditional Bank</p>
                            <p class="text-gray-300 text-sm">Tom would benefit from easy cash deposits, face-to-face service, and nearby ATMs.</p>
                        </div>
                    </div>
                </div>

                <div class="comparison-card rounded-3xl p-8 text-center">
                    <h3 class="text-2xl font-bold text-gray-200 mb-4">Real Talk</h3>
                    <p class="text-gray-400">You can always switch banks later. This isn't a forever decision. Many people actually use BOTHâ€”an online bank for savings (better interest) and a traditional bank for everyday stuff.</p>
                </div>

                <div class="text-center mt-12">
                    <button onclick="nextSection()" class="btn-3d px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-xl font-bold text-white text-lg">
                        Continue â†’
                    </button>
                </div>
            </div>

            <!-- Section 4: Quiz -->
            <div id="section4" class="mb-24 hidden">
                <h2 class="text-3xl font-bold text-gray-200 mb-4 text-center">Lesson Quiz</h2>
                <p class="text-center text-gray-400 mb-12">Answer all questions correctly to complete the lesson (You need 100%)</p>

                <div id="quizContainer" class="space-y-6 mb-12"></div>

                <div class="text-center">
                    <button id="submitQuizBtn" onclick="submitQuiz()" class="btn-3d px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-xl font-bold text-white text-lg">
                        Submit Quiz
                    </button>
                </div>

                <div id="quizResult" class="hidden mt-12"></div>

                <div id="finishSection" class="text-center mt-12 hidden">
                    <button onclick="finishLesson()" class="btn-3d px-10 py-5 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-xl font-bold text-white text-xl glow-green pulse-animation">
                        Finish Lesson âœ“
                    </button>
                </div>
            </div>
        </div>
    </section>

    <script src="config.js"></script>
    <script src="lesson-completion.js"></script>
    <script>
        // Floating particles
        function createParticles() {
            const container = document.getElementById('particles-container');
            const particleCount = 30;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';

                const size = Math.random() * 4 + 2;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.background = `rgba(156, 163, 175, ${Math.random() * 0.5 + 0.2})`;
                particle.style.animation = `float ${Math.random() * 10 + 10}s ease-in-out infinite`;
                particle.style.animationDelay = `${Math.random() * 5}s`;

                container.appendChild(particle);
            }
        }

        createParticles();

        // Navigation
        let currentSection = 1;
        const totalSections = 4;

        function updateProgress() {
            const progress = (currentSection / totalSections) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
        }

        function nextSection() {
            document.getElementById(`section${currentSection}`).classList.add('hidden');
            currentSection++;
            document.getElementById(`section${currentSection}`).classList.remove('hidden');
            document.getElementById(`section${currentSection}`).classList.add('fade-in');
            updateProgress();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Flip card
        function toggleFlip(card) {
            card.classList.toggle('flipped');
        }

        // Scenario selection
        function selectScenario(type, card) {
            // Remove selection from all cards
            document.querySelectorAll('.scenario-card').forEach(c => {
                c.classList.remove('selected');
                c.querySelector('.scenario-result').classList.add('hidden');
            });

            // Select this card
            card.classList.add('selected');
            card.querySelector('.scenario-result').classList.remove('hidden');
        }

        // Quiz data
        const quizQuestions = [
            {
                question: "What's the main advantage of online banks?",
                options: [
                    "They have physical branches",
                    "Lower fees and better interest rates",
                    "Easier to deposit cash",
                    "More ATMs"
                ],
                correct: 1
            },
            {
                question: "What's a major downside of online banks?",
                options: [
                    "They're not FDIC insured",
                    "Can't deposit checks",
                    "Can't walk into a physical branch",
                    "Don't offer savings accounts"
                ],
                correct: 2
            },
            {
                question: "Who would benefit most from a traditional bank?",
                options: [
                    "Someone comfortable with tech who rarely uses cash",
                    "Someone who prefers face-to-face service and deposits cash often",
                    "Someone who never needs customer service",
                    "Someone who doesn't care about fees"
                ],
                correct: 1
            },
            {
                question: "Can you switch banks later if you don't like your choice?",
                options: [
                    "No, you're stuck forever",
                    "Yes, and many people use both types",
                    "Only if you pay a large fee",
                    "Only after 10 years"
                ],
                correct: 1
            }
        ];

        let userAnswers = new Array(quizQuestions.length).fill(null);
        let quizPassed = false;

        function initQuiz() {
            const userId = localStorage.getItem('userId');
            if (!userId || userId === 'null' || userId === 'undefined') {
                return;
            }

            const quizPassedStatus = localStorage.getItem(`lesson1_quiz_passed_${userId}`);
            if (quizPassedStatus === 'true') {
                quizPassed = true;
                document.getElementById('quizContainer').innerHTML = '<div class="comparison-card rounded-3xl p-8 text-center"><p class="text-green-400 text-xl font-bold">âœ“ Quiz Already Completed</p></div>';
                document.getElementById('submitQuizBtn').classList.add('hidden');
                document.getElementById('finishSection').classList.remove('hidden');
                return;
            }

            renderQuiz();
        }

        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            quizQuestions.forEach((q, qIndex) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'comparison-card quiz-question-card rounded-3xl p-8';
                questionDiv.setAttribute('data-question', qIndex);
                questionDiv.innerHTML = `
                    <h3 class="text-xl font-bold text-gray-200 mb-6">Question ${qIndex + 1}: ${q.question}</h3>
                    <div class="space-y-3">
                        ${q.options.map((option, oIndex) => `
                            <div class="quiz-option rounded-xl p-4" onclick="selectAnswer(${qIndex}, ${oIndex})">
                                <input type="radio" name="question${qIndex}" value="${oIndex}" class="mr-3">
                                <span class="text-gray-300">${option}</span>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            const questionCard = document.querySelector(`.quiz-question-card[data-question="${questionIndex}"]`);
            const options = questionCard.querySelectorAll('.quiz-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === optionIndex) {
                    opt.classList.add('selected');
                    opt.querySelector('input').checked = true;
                }
            });
        }

        function submitQuiz() {
            if (userAnswers.includes(null)) {
                alert('Please answer all questions before submitting.');
                return;
            }

            let correct = 0;
            quizQuestions.forEach((q, index) => {
                if (userAnswers[index] === q.correct) {
                    correct++;
                }
            });

            const passed = correct === quizQuestions.length;

            // Show correct/incorrect
            document.querySelectorAll('.quiz-question-card').forEach((card, qIndex) => {
                const options = card.querySelectorAll('.quiz-option');
                options.forEach((opt, oIndex) => {
                    opt.style.pointerEvents = 'none';
                    if (oIndex === quizQuestions[qIndex].correct) {
                        opt.classList.add('correct');
                    } else if (oIndex === userAnswers[qIndex] && oIndex !== quizQuestions[qIndex].correct) {
                        opt.classList.add('incorrect');
                    }
                });
            });

            const resultDiv = document.getElementById('quizResult');
            if (passed) {
                quizPassed = true;
                const userId = localStorage.getItem('userId');
                localStorage.setItem(`lesson1_quiz_passed_${userId}`, 'true');

                resultDiv.innerHTML = `
                    <div class="comparison-card rounded-3xl p-10 text-center glow-green">
                        <div class="text-6xl mb-4">ðŸŽ‰</div>
                        <h3 class="text-3xl font-bold text-green-400 mb-4">Perfect Score!</h3>
                        <p class="text-gray-300 text-lg mb-2">You scored ${correct} out of ${quizQuestions.length} (100%)</p>
                        <p class="text-gray-400">Great job! You can now finish the lesson.</p>
                    </div>
                `;
                document.getElementById('finishSection').classList.remove('hidden');
            } else {
                resultDiv.innerHTML = `
                    <div class="comparison-card rounded-3xl p-10 text-center" style="border-color: rgba(239, 68, 68, 0.6);">
                        <div class="text-6xl mb-4">ðŸ“š</div>
                        <h3 class="text-3xl font-bold text-red-400 mb-4">Not quite there yet</h3>
                        <p class="text-gray-300 text-lg mb-2">You scored ${correct} out of ${quizQuestions.length}</p>
                        <p class="text-gray-400 mb-6">You need 100% to pass. Review and try again!</p>
                        <button onclick="retryQuiz()" class="btn-3d px-8 py-4 bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700 rounded-xl font-bold text-white text-lg">
                            Retry Quiz
                        </button>
                    </div>
                `;
            }

            resultDiv.classList.remove('hidden');
            document.getElementById('submitQuizBtn').classList.add('hidden');
        }

        function retryQuiz() {
            userAnswers = new Array(quizQuestions.length).fill(null);
            renderQuiz();
            document.getElementById('quizResult').classList.add('hidden');
            document.getElementById('submitQuizBtn').classList.remove('hidden');
            window.scrollTo({ top: document.getElementById('quizContainer').offsetTop - 100, behavior: 'smooth' });
        }

        async function finishLesson() {
            if (!quizPassed) {
                alert('Please complete the quiz first!');
                return;
            }

            const success = await completeLesson('path1_lesson1', 1, 1);
            if (success) {
                window.location.href = 'path1-lessons.html';
            }
        }

        // Logout
        async function logout() {
            localStorage.removeItem('authState');
            localStorage.removeItem('token');
            localStorage.removeItem('userId');
            try {
                await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/index.html';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/index.html';
            }
        }

        // Initialize
        updateProgress();
        initQuiz();
    </script>
</body>
</html>
