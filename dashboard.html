<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - FinanceU</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: #0f0f0f;
            overflow-x: hidden;
        }

        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, #e5e7eb 0%, #9ca3af 50%, #e5e7eb 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 5s ease infinite;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Glowing effects */
        .glow-grey {
            box-shadow: 0 0 20px rgba(156, 163, 175, 0.4), 0 0 40px rgba(156, 163, 175, 0.2);
        }

        /* Navigation */
        .nav-blur {
            backdrop-filter: blur(12px);
            background: rgba(15, 15, 15, 0.9);
            border-bottom: 1px solid rgba(156, 163, 175, 0.15);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        /* 3D Button Effect */
        .btn-3d {
            transform-style: preserve-3d;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3), 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .btn-3d:hover {
            transform: translateY(-4px) translateZ(10px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.4), 0 16px 32px rgba(0, 0, 0, 0.3), 0 0 40px rgba(209, 213, 219, 0.2);
        }

        /* Stat card with progress ring */
        .stat-card {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.8) 0%, rgba(17, 24, 39, 0.9) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(75, 85, 99, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(156, 163, 175, 0.05), transparent);
            transform: rotate(0deg);
            animation: shimmer 3s linear infinite;
        }

        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stat-card:hover {
            transform: translateY(-4px);
            border-color: rgba(156, 163, 175, 0.5);
        }

        /* Circular progress */
        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            transition: stroke-dashoffset 1s ease;
        }

        /* Streak flame animation */
        @keyframes flicker {
            0%, 100% { transform: scale(1) translateY(0); opacity: 1; }
            50% { transform: scale(1.1) translateY(-2px); opacity: 0.8; }
        }

        .flame {
            animation: flicker 1.5s ease-in-out infinite;
        }

        /* Path card styles - different for each path */
        .path-card {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(17, 24, 39, 0.95) 100%);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(75, 85, 99, 0.4);
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            position: relative;
        }

        .path-card:hover {
            transform: translateY(-12px) rotateX(2deg);
            border-color: rgba(156, 163, 175, 0.6);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9), 0 0 60px rgba(156, 163, 175, 0.3);
        }

        /* Path 1 - Blue/Cyan theme */
        .path-1 {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .path-1:hover {
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9), 0 0 60px rgba(59, 130, 246, 0.3);
        }

        /* Path 2 - Green theme */
        .path-2 {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            border-color: rgba(34, 197, 94, 0.3);
        }

        .path-2:hover {
            border-color: rgba(34, 197, 94, 0.6);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9), 0 0 60px rgba(34, 197, 94, 0.3);
        }

        /* Path 3 - Purple theme */
        .path-3 {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            border-color: rgba(168, 85, 247, 0.3);
        }

        .path-3:hover {
            border-color: rgba(168, 85, 247, 0.6);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9), 0 0 60px rgba(168, 85, 247, 0.3);
        }

        /* Path 4 - Orange theme */
        .path-4 {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            border-color: rgba(249, 115, 22, 0.3);
        }

        .path-4:hover {
            border-color: rgba(249, 115, 22, 0.6);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9), 0 0 60px rgba(249, 115, 22, 0.3);
        }

        /* Path 5 - Pink theme */
        .path-5 {
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.1) 0%, rgba(17, 24, 39, 0.95) 100%);
            border-color: rgba(236, 72, 153, 0.3);
        }

        .path-5:hover {
            border-color: rgba(236, 72, 153, 0.6);
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.9), 0 0 60px rgba(236, 72, 153, 0.3);
        }

        /* Floating particles */
        .particle {
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.4;
            will-change: transform;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0) translateX(0) rotate(0deg) scale(1);
                opacity: 0.3;
            }
            25% {
                transform: translateY(-20px) translateX(20px) rotate(90deg) scale(1.2);
                opacity: 0.5;
            }
            50% {
                transform: translateY(-40px) translateX(-10px) rotate(180deg) scale(1);
                opacity: 0.4;
            }
            75% {
                transform: translateY(-20px) translateX(-30px) rotate(270deg) scale(1.1);
                opacity: 0.6;
            }
        }

        /* Coming soon badge */
        .coming-soon-badge {
            font-size: 0.65rem;
            padding: 0.15rem 0.5rem;
            background: rgba(156, 163, 175, 0.2);
            border: 1px solid rgba(156, 163, 175, 0.3);
            border-radius: 4px;
            color: #9ca3af;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-left: 0.5rem;
        }

        /* Tip card animation */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .tip-card {
            animation: slideIn 0.6s ease;
        }

        /* Path grid layout */
        .path-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
        }

        @media (min-width: 768px) {
            .path-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .path-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Number count animation */
        .count-up {
            display: inline-block;
        }
    </style>
</head>
<body class="min-h-screen relative" style="color: #d1d5db;">
    <!-- Floating Particles -->
    <div id="particles-container" style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 1;"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 nav-blur">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="/" class="flex items-center space-x-2">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-gray-200 to-gray-400 glow-grey flex items-center justify-center font-bold text-xl" style="color: #1f2937;">
                        F
                    </div>
                    <span class="text-2xl font-bold gradient-text">FinanceU</span>
                </a>

                <div class="hidden md:flex items-center space-x-6">
                    <a href="/dashboard" class="text-gray-200 font-semibold transition-colors">Dashboard</a>
                    <button onclick="showComingSoon('Your Finances')" class="text-gray-400 hover:text-gray-200 transition-colors font-medium">
                        Your Finances
                    </button>
                    <button onclick="showComingSoon('Quiz Me')" class="text-gray-400 hover:text-gray-200 transition-colors font-medium">
                        Quiz Me
                    </button>
                </div>

                <div class="flex items-center space-x-4">
                    <button onclick="logout()" class="btn-3d px-6 py-2.5 bg-gradient-to-r from-gray-200 to-gray-300 hover:from-gray-300 hover:to-gray-200 rounded-lg font-semibold glow-grey transition-all" style="color: #1f2937;">
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <section class="min-h-screen pt-32 pb-20 relative z-10">
        <div class="container mx-auto px-6">
            <!-- Loading State -->
            <div id="loading" class="text-center py-20">
                <p class="text-gray-400 text-lg">Loading your dashboard...</p>
            </div>

            <!-- Error State -->
            <div id="error" class="bg-red-500/10 border border-red-500/30 text-red-400 px-6 py-4 rounded-xl mb-8 hidden"></div>

            <!-- Dashboard Content -->
            <div id="dashboardContent" style="display: none;">
                <!-- Welcome Section -->
                <div class="mb-12">
                    <h1 class="text-4xl md:text-5xl font-black mb-3 text-gray-200">
                        Welcome back, <span id="userName" class="gradient-text">Student</span>! ðŸ‘‹
                    </h1>
                    <p class="text-lg text-gray-400">Continue your journey to financial mastery</p>
                </div>

                <!-- Stats Grid with Interactive Elements -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12">
                    <!-- Lessons Completed with Progress Ring -->
                    <div class="stat-card rounded-2xl p-6 relative">
                        <div class="flex flex-col items-center justify-center relative">
                            <svg class="w-32 h-32">
                                <circle class="progress-ring-circle" stroke="rgba(75, 85, 99, 0.3)" stroke-width="8" fill="transparent" r="52" cx="64" cy="64"/>
                                <circle id="lessonsProgressRing" class="progress-ring-circle progress-ring" stroke="#3b82f6" stroke-width="8" fill="transparent" r="52" cx="64" cy="64" stroke-dasharray="326.73" stroke-dashoffset="326.73"/>
                            </svg>
                            <div class="absolute inset-0 flex flex-col items-center justify-center">
                                <div class="text-4xl font-black text-gray-200 count-up" id="completedLessons">0</div>
                                <div class="text-sm text-gray-400 font-medium mt-1">Lessons</div>
                            </div>
                        </div>
                    </div>

                    <!-- Overall Progress -->
                    <div class="stat-card rounded-2xl p-6 relative">
                        <div class="flex flex-col items-center justify-center relative">
                            <svg class="w-32 h-32">
                                <circle class="progress-ring-circle" stroke="rgba(75, 85, 99, 0.3)" stroke-width="8" fill="transparent" r="52" cx="64" cy="64"/>
                                <circle id="overallProgressRing" class="progress-ring-circle progress-ring" stroke="#10b981" stroke-width="8" fill="transparent" r="52" cx="64" cy="64" stroke-dasharray="326.73" stroke-dashoffset="326.73"/>
                            </svg>
                            <div class="absolute inset-0 flex flex-col items-center justify-center">
                                <div class="text-4xl font-black text-gray-200 count-up" id="progressPercent">0%</div>
                                <div class="text-sm text-gray-400 font-medium mt-1">Progress</div>
                            </div>
                        </div>
                    </div>

                    <!-- Streak Counter -->
                    <div class="stat-card rounded-2xl p-6 relative">
                        <div class="flex flex-col items-center">
                            <div class="flame text-6xl mb-2">ðŸ”¥</div>
                            <div class="text-4xl font-black text-orange-400 count-up" id="streakDays">0</div>
                            <div class="text-sm text-gray-400 font-medium mt-1">Day Streak</div>
                        </div>
                    </div>

                    <!-- Member Days -->
                    <div class="stat-card rounded-2xl p-6 relative">
                        <div class="flex flex-col items-center">
                            <svg class="w-16 h-16 text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                            <div class="text-4xl font-black text-gray-200 count-up" id="memberDays">0</div>
                            <div class="text-sm text-gray-400 font-medium mt-1">Days</div>
                        </div>
                    </div>
                </div>

                <!-- Daily Tip Card -->
                <div class="tip-card stat-card rounded-2xl p-6 mb-12 relative overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="text-4xl">ðŸ’¡</div>
                        <div class="flex-1">
                            <h3 class="text-xl font-bold text-gray-200 mb-2">Today's Financial Tip</h3>
                            <p class="text-gray-400 leading-relaxed" id="dailyTip">Track every dollar you spend for a week. You'll be surprised where your money actually goes!</p>
                        </div>
                    </div>
                </div>

                <!-- Your Learning Paths -->
                <div class="mb-12">
                    <h2 class="text-3xl font-bold mb-8 text-gray-200">
                        Your Learning <span class="gradient-text">Paths</span>
                    </h2>

                    <div class="path-grid">
                        <!-- Path 1: Banking Basics -->
                        <div class="path-card path-1 rounded-2xl p-6" id="path1Item">
                            <div class="flex flex-col h-full">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="w-14 h-14 rounded-xl bg-blue-500/20 border border-blue-500/30 flex items-center justify-center flex-shrink-0">
                                        <svg class="w-7 h-7 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                                        </svg>
                                    </div>
                                    <span class="px-2 py-1 bg-green-500/20 border border-green-500/30 text-green-400 text-xs font-bold rounded uppercase">Free</span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-200 mb-2">Banking Basics</h3>
                                <p class="text-gray-400 text-sm leading-relaxed mb-4 flex-1">Master the fundamentals of banking and financial accounts.</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-blue-400 text-sm font-semibold" id="path1AvailabilityBadge">Available Now</span>
                                    <a href="/path1-lessons" class="btn-3d px-6 py-2 bg-blue-500/80 hover:bg-blue-600 rounded-lg font-bold text-white transition-all text-sm" id="path1Button">
                                        Start
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Path 2: Budgeting & Saving -->
                        <div class="path-card path-2 rounded-2xl p-6 opacity-60">
                            <div class="flex flex-col h-full">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="w-14 h-14 rounded-xl bg-green-500/20 border border-green-500/30 flex items-center justify-center flex-shrink-0">
                                        <svg class="w-7 h-7 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                        </svg>
                                    </div>
                                    <span class="px-2 py-1 bg-gray-700/50 border border-gray-600 text-gray-400 text-xs font-bold rounded uppercase">2026</span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-200 mb-2">Budgeting & Saving</h3>
                                <p class="text-gray-400 text-sm leading-relaxed mb-4 flex-1">Master budgeting and saving strategies.</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-500 text-sm font-semibold">Coming Soon</span>
                                </div>
                            </div>
                        </div>

                        <!-- Path 3: Credit Building -->
                        <div class="path-card path-3 rounded-2xl p-6 opacity-60">
                            <div class="flex flex-col h-full">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="w-14 h-14 rounded-xl bg-purple-500/20 border border-purple-500/30 flex items-center justify-center flex-shrink-0">
                                        <svg class="w-7 h-7 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                        </svg>
                                    </div>
                                    <span class="px-2 py-1 bg-gray-700/50 border border-gray-600 text-gray-400 text-xs font-bold rounded uppercase">2026</span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-200 mb-2">Credit Building</h3>
                                <p class="text-gray-400 text-sm leading-relaxed mb-4 flex-1">Master credit scores and debt management.</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-500 text-sm font-semibold">Coming Soon</span>
                                </div>
                            </div>
                        </div>

                        <!-- Path 4: Smart Saving -->
                        <div class="path-card path-4 rounded-2xl p-6 opacity-60">
                            <div class="flex flex-col h-full">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="w-14 h-14 rounded-xl bg-orange-500/20 border border-orange-500/30 flex items-center justify-center flex-shrink-0">
                                        <svg class="w-7 h-7 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                        </svg>
                                    </div>
                                    <span class="px-2 py-1 bg-gray-700/50 border border-gray-600 text-gray-400 text-xs font-bold rounded uppercase">2026</span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-200 mb-2">Smart Saving</h3>
                                <p class="text-gray-400 text-sm leading-relaxed mb-4 flex-1">Smart saving strategies and emergency funds.</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-500 text-sm font-semibold">Coming Soon</span>
                                </div>
                            </div>
                        </div>

                        <!-- Path 5: Career & Income -->
                        <div class="path-card path-5 rounded-2xl p-6 opacity-60">
                            <div class="flex flex-col h-full">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="w-14 h-14 rounded-xl bg-pink-500/20 border border-pink-500/30 flex items-center justify-center flex-shrink-0">
                                        <svg class="w-7 h-7 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                        </svg>
                                    </div>
                                    <span class="px-2 py-1 bg-gray-700/50 border border-gray-600 text-gray-400 text-xs font-bold rounded uppercase">2026</span>
                                </div>
                                <h3 class="text-xl font-bold text-gray-200 mb-2">Career & Income</h3>
                                <p class="text-gray-400 text-sm leading-relaxed mb-4 flex-1">Investment principles and wealth building.</p>
                                <div class="flex items-center justify-between">
                                    <span class="text-gray-500 text-sm font-semibold">Coming Soon</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Reset Progress Section -->
                <div class="stat-card rounded-2xl p-8">
                    <div class="text-center">
                        <h3 class="text-xl font-bold text-gray-400 mb-2">Development Tools</h3>
                        <p class="text-gray-500 text-sm mb-6">Reset your progress to test lessons from the beginning</p>
                        <button onclick="resetProgress()" class="btn-3d px-8 py-3 bg-red-500/80 hover:bg-red-600 rounded-xl font-bold text-white transition-all">
                            Reset All Progress
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Create floating particles
        function createParticles() {
            const container = document.getElementById('particles-container');
            const particleCount = 40;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';

                const size = Math.random() * 6 + 3;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.background = `rgba(156, 163, 175, ${Math.random() * 0.6 + 0.3})`;
                particle.style.animation = `float ${Math.random() * 8 + 8}s ease-in-out infinite`;
                particle.style.animationDelay = `${Math.random() * 5}s`;

                container.appendChild(particle);
            }
        }

        // Animate counter numbers
        function animateCounter(element, target) {
            let current = 0;
            const increment = target / 50;
            const isPercentage = element.id === 'progressPercent';

            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                element.textContent = isPercentage ? Math.round(current) + '%' : Math.round(current);
            }, 30);
        }

        // Update circular progress ring
        function updateProgressRing(ringId, percent) {
            const circle = document.getElementById(ringId);
            const circumference = 2 * Math.PI * 52;
            const offset = circumference - (percent / 100) * circumference;

            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
            }, 100);
        }

        // Calculate streak (simple version - days since last visit)
        function calculateStreak(userId) {
            const lastVisit = localStorage.getItem(`lastVisit_${userId}`);
            const today = new Date().toDateString();

            if (lastVisit === today) {
                return parseInt(localStorage.getItem(`streak_${userId}`) || '1');
            }

            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);

            if (lastVisit === yesterday.toDateString()) {
                const newStreak = parseInt(localStorage.getItem(`streak_${userId}`) || '0') + 1;
                localStorage.setItem(`streak_${userId}`, newStreak);
                localStorage.setItem(`lastVisit_${userId}`, today);
                return newStreak;
            }

            localStorage.setItem(`streak_${userId}`, '1');
            localStorage.setItem(`lastVisit_${userId}`, today);
            return 1;
        }

        // Daily tips rotation
        const dailyTips = [
            "Track every dollar you spend for a week. You'll be surprised where your money actually goes!",
            "Pay yourself first! Set up automatic transfers to savings before you spend on anything else.",
            "Your credit score is like a financial report card. Check it regularly and work to improve it.",
            "Emergency funds aren't optional - aim for 3-6 months of expenses saved up.",
            "The best time to start investing was yesterday. The second best time is today!",
            "Never invest in something you don't understand. Take time to learn before you invest.",
            "Compound interest is your best friend when saving, but your worst enemy in debt.",
            "A budget isn't restrictive - it's a plan for spending your money intentionally."
        ];

        function getDailyTip() {
            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
            return dailyTips[dayOfYear % dailyTips.length];
        }

        createParticles();

        // Show coming soon message
        function showComingSoon(feature) {
            alert(`ðŸš€ ${feature} is coming soon!\n\nWe're working hard to bring you this feature. Stay tuned for updates!`);
        }
    </script>

    <script src="config.js"></script>
    <script>
        async function checkAuth() {
            try {
                const response = await fetch(`${API_URL}/auth/me`, {
                    credentials: 'include'
                });

                if (!response.ok) {
                    window.location.href = '/login.html';
                    return null;
                }

                const data = await response.json();
                return data.user;
            } catch (error) {
                console.error('Auth check failed:', error);
                window.location.href = '/login.html';
                return null;
            }
        }

        async function loadDashboard() {
            const user = await checkAuth();
            if (!user) return;

            try {
                document.getElementById('userName').textContent = user.name;

                // Set daily tip
                document.getElementById('dailyTip').textContent = getDailyTip();

                const createdDate = new Date(user.createdAt);
                const today = new Date();
                const daysDiff = Math.floor((today - createdDate) / (1000 * 60 * 60 * 24));
                const days = Math.max(0, daysDiff);

                const [profileRes, lessonsRes, progressRes] = await Promise.all([
                    fetch(`${API_URL}/users/profile`, { credentials: 'include' }),
                    fetch(`${API_URL}/lessons`, { credentials: 'include' }),
                    fetch(`${API_URL}/lessons/progress`, { credentials: 'include' })
                ]);

                const profile = await profileRes.json();
                const lessonsData = await lessonsRes.json();
                const progressData = await progressRes.json();

                const userId = user.id;
                const path1Completed = JSON.parse(localStorage.getItem(`pillar1_completed_${userId}`) || '[]');
                const path1QuizCompleted = localStorage.getItem(`path1_quiz_completed_${userId}`) === 'true';
                const path2Completed = JSON.parse(localStorage.getItem(`path2_completed_${userId}`) || '[]');
                const path2QuizCompleted = localStorage.getItem(`path2_quiz_completed_${userId}`) === 'true';
                const path3Completed = JSON.parse(localStorage.getItem(`path3_completed_${userId}`) || '[]');
                const path3QuizCompleted = localStorage.getItem(`path3_quiz_completed_${userId}`) === 'true';
                const path4Completed = JSON.parse(localStorage.getItem(`path4_completed_${userId}`) || '[]');
                const path4QuizCompleted = localStorage.getItem(`path4_quiz_completed_${userId}`) === 'true';

                const totalLessonsPerPath = 8;
                const totalItemsPerPath = 9;
                const totalCompletedLessons = path1Completed.length + path2Completed.length + path3Completed.length + path4Completed.length;

                const totalAvailableLessons = totalLessonsPerPath * 2;
                const totalAvailableItems = totalItemsPerPath * 2;
                const path1QuizBonus = path1QuizCompleted ? 1 : 0;
                const path2QuizBonus = path2QuizCompleted ? 1 : 0;
                const totalCompletedItems = totalCompletedLessons + path1QuizBonus + path2QuizBonus;

                let progressPercent = Math.round((totalCompletedItems / totalAvailableItems) * 100);

                // Animate counters
                animateCounter(document.getElementById('completedLessons'), totalCompletedLessons);
                animateCounter(document.getElementById('progressPercent'), progressPercent);
                animateCounter(document.getElementById('memberDays'), days);

                // Update progress rings
                const lessonsPercent = (totalCompletedLessons / totalAvailableLessons) * 100;
                updateProgressRing('lessonsProgressRing', lessonsPercent);
                updateProgressRing('overallProgressRing', progressPercent);

                // Calculate and display streak
                const streak = calculateStreak(userId);
                animateCounter(document.getElementById('streakDays'), streak);

                const path1Button = document.getElementById('path1Button');
                const path1Item = document.getElementById('path1Item');
                const path1AvailabilityBadge = document.getElementById('path1AvailabilityBadge');

                if (path1QuizCompleted === true) {
                    path1Button.textContent = 'Review';
                    path1Item.style.borderColor = '#10b981';
                    path1AvailabilityBadge.style.color = '#10b981';
                    path1AvailabilityBadge.textContent = 'âœ“ Complete';
                } else if (path1Completed.length > 0) {
                    path1Button.textContent = 'Continue';
                } else {
                    path1Button.textContent = 'Start';
                }

                document.getElementById('loading').style.display = 'none';
                document.getElementById('dashboardContent').style.display = 'block';

            } catch (error) {
                console.error('Error loading dashboard:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').textContent = 'Error loading dashboard. Please try again.';
                document.getElementById('error').classList.remove('hidden');
            }
        }

        async function logout() {
            localStorage.removeItem('authState');
            localStorage.removeItem('token');
            localStorage.removeItem('userId');

            try {
                await fetch(`${API_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/index.html';
            } catch (error) {
                console.error('Logout error:', error);
                window.location.href = '/index.html';
            }
        }

        function resetProgress() {
            const confirmed = confirm('Are you sure you want to reset all your progress?\n\nThis will clear:\n- All completed lessons\n- All quiz scores\n- All lesson progress\n\nThis action cannot be undone.');

            if (!confirmed) return;

            const userId = localStorage.getItem('userId');
            if (!userId || userId === 'null' || userId === 'undefined') {
                alert('No user logged in. Nothing to reset.');
                return;
            }

            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.includes(userId) && (
                    key.includes('completed') ||
                    key.includes('quiz_passed') ||
                    key.includes('quiz_score') ||
                    key.includes('quiz_completed')
                )) {
                    keysToRemove.push(key);
                }
            }

            keysToRemove.forEach(key => localStorage.removeItem(key));

            alert(`Progress reset successfully!\n\nCleared ${keysToRemove.length} progress items.\n\nThe page will now refresh.`);
            window.location.reload();
        }

        loadDashboard();
    </script>
</body>
</html>
